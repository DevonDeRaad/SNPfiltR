<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Vizualise and filter based on mean depth across all called SNPs — max_depth • SNPfiltR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Vizualise and filter based on mean depth across all called SNPs — max_depth"><meta property="og:description" content="This function can be run in two ways: 1) specify vcfR object only. This will
visualize the distribution of mean depth per sample across all SNPs in your vcf file,
and will not alter your vcf file. 2) specify vcfR object, and set 'maxdepth' = 'integer value'.
This option will show you where your specified cutoff falls in the distribution of SNP depth,
and remove all SNPs with a mean depth above the specified threshold from the vcf.
Super high depth loci are likely multiple loci stuck together into a single paralogous locus.
Note: This function filters on a 'per SNP' basis rather than a 'per genotype' basis,
otherwise it would disproportionately remove genotypes from our deepest sequenced samples
(because sequencing depth is so variable between samples)."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SNPfiltR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/accuracy-benchmarking.html">accuracy-benchmarking</a>
    </li>
    <li>
      <a href="../articles/performance-benchmarking.html">Performance benchmarking</a>
    </li>
    <li>
      <a href="../articles/reproducible-vignette.html">reproducible-vignette</a>
    </li>
    <li>
      <a href="../articles/scrub-jay-RADseq-vignette.html">scrub-jay-RADseq-vignette</a>
    </li>
    <li>
      <a href="../articles/scrub-jay-UCE-vignette.html">scrub-jay-UCE-vignette</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Vizualise and filter based on mean depth across all called SNPs</h1>
    
    <div class="hidden name"><code>max_depth.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function can be run in two ways: 1) specify vcfR object only. This will
visualize the distribution of mean depth per sample across all SNPs in your vcf file,
and will not alter your vcf file. 2) specify vcfR object, and set 'maxdepth' = 'integer value'.
This option will show you where your specified cutoff falls in the distribution of SNP depth,
and remove all SNPs with a mean depth above the specified threshold from the vcf.
Super high depth loci are likely multiple loci stuck together into a single paralogous locus.
Note: This function filters on a 'per SNP' basis rather than a 'per genotype' basis,
otherwise it would disproportionately remove genotypes from our deepest sequenced samples
(because sequencing depth is so variable between samples).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">max_depth</span><span class="op">(</span><span class="va">vcfR</span>, maxdepth <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>vcfR</dt>
<dd><p>a vcfR object</p></dd>


<dt>maxdepth</dt>
<dd><p>an integer specifying the maximum mean depth for a SNP to be retained</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The vcfR object input, with SNPs above the 'maxdepth' cutoff removed</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">max_depth</span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu">SNPfiltR</span><span class="fu">::</span><span class="va"><a href="vcfR.example.html">vcfR.example</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> cutoff is not specified, exploratory visualization will be generated.</span>
<span class="r-plt img"><img src="max_depth-1.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> dashed line indicates a mean depth across all SNPs of 47</span>
<span class="r-plt img"><img src="max_depth-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">max_depth</span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu">SNPfiltR</span><span class="fu">::</span><span class="va"><a href="vcfR.example.html">vcfR.example</a></span>, maxdepth <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> maxdepth cutoff is specified, filtered vcfR object will be returned</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 17% of SNPs were above a mean depth of 100 and were removed from the vcf</span>
<span class="r-plt img"><img src="max_depth-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ***** Object of Class vcfR *****</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 CHROMs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 415 variants</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object size: 0.5 Mb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44.22 percent missing data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *****        *****         *****</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Devon DeRaad.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

