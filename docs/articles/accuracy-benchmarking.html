<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>accuracy-benchmarking • SNPfiltR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="accuracy-benchmarking">
<meta property="og:description" content="SNPfiltR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SNPfiltR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/accuracy-benchmarking.html">accuracy-benchmarking</a>
    </li>
    <li>
      <a href="../articles/performance-benchmarking.html">Performance benchmarking</a>
    </li>
    <li>
      <a href="../articles/reproducible-vignette.html">reproducible-vignette</a>
    </li>
    <li>
      <a href="../articles/scrub-jay-RADseq-vignette.html">scrub-jay-RADseq-vignette</a>
    </li>
    <li>
      <a href="../articles/scrub-jay-UCE-vignette.html">scrub-jay-UCE-vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>accuracy-benchmarking</h1>
            
      
      
      <div class="hidden name"><code>accuracy-benchmarking.Rmd</code></div>

    </div>

    
    
<p>This vignette is designed to validate the accuracy of the key
functions from the SNPfiltR package against the established VCFtools
program. For each function, I filtered 3 vcf files according to the same
parameter thresholds using SNPfiltR and VCFtools, and then tested
whether each genotype in the output vcf files matched. All functions
matched exactly, except for the distance_thin() function. It seems that
the SNPfiltR approach accurately thinned the dataset, while the ‘–thin
100’ flag from VCFtools allowed SNPs to remain in the output dataset
despite being within 100 base pairs of nearby SNPs. I am not sure why
VCFtools is less accurate on these vcf files I used for testing, and
encourage more testing from other users in case this is an idiosyncratic
issue with the particular vcf files I used. Meanwhile, I suggest using
the SNPfiltR function distance_thin() which is validated clearly here,
over the VCFtools approach.</p>
<p>All of the input vcf files necessary to fully reproduce this accuracy
comparison can be found <a href="https://github.com/DevonDeRaad/SNPfiltR.benchmarking.data" class="external-link">here</a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SNPfiltR</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This is SNPfiltR v.1.0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detailed usage information is available at: devonderaad.github.io/SNPfiltR/ </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## If you use SNPfiltR in your published work, please cite the following papers: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## DeRaad, D.A. (2022), SNPfiltR: an R package for interactive and reproducible SNP filtering. Molecular Ecology Resources, 00, 1-15. http://doi.org/10.1111/1755-0998.13618 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Knaus, Brian J., and Niklaus J. Grunwald. 2017. VCFR: a package to manipulate and visualize variant call format data in R. Molecular Ecology Resources, 17.1:44-53. http://doi.org/10.1111/1755-0998.12549</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/knausb/vcfR" class="external-link">vcfR</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##    *****       ***   vcfR   ***       *****</span></span>
<span><span class="co">##    This is vcfR 1.14.0 </span></span>
<span><span class="co">##      browseVignettes('vcfR') # Documentation</span></span>
<span><span class="co">##      citation('vcfR') # Citation</span></span>
<span><span class="co">##    *****       *****      *****       *****</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="validate-the-hard_filter-function">Validate the hard_filter() function<a class="anchor" aria-label="anchor" href="#validate-the-hard_filter-function"></a>
</h2>
<div class="section level4">
<h4 id="filter-each-vcf-with-snpfiltr">Filter each vcf with SNPfiltR<a class="anchor" aria-label="anchor" href="#filter-each-vcf-with-snpfiltr"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#perform filtering on the 10K SNP vcf file and save the result</span></span>
<span><span class="va">r.10k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/hard_filter.html">hard_filter</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.10K.vcf.gz"</span><span class="op">)</span>,depth <span class="op">=</span> <span class="fl">5</span>,gq <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 10000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 10000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 10000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant: 10000
## All variants processed</code></pre>
<pre><code><span><span class="co">## 32.58% of genotypes fall below a read depth of 5 and were converted to NA</span></span></code></pre>
<pre><code><span><span class="co">## 1.36% of genotypes fall below a genotype quality of 30 and were converted to NA</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r.20k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/hard_filter.html">hard_filter</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.20K.vcf.gz"</span><span class="op">)</span>,depth <span class="op">=</span> <span class="fl">5</span>,gq <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 20000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 20000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 20000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant 16000
Processed variant 17000
Processed variant 18000
Processed variant 19000
Processed variant 20000
Processed variant: 20000
## All variants processed</code></pre>
<pre><code><span><span class="co">## 30.09% of genotypes fall below a read depth of 5 and were converted to NA</span></span></code></pre>
<pre><code><span><span class="co">## 1.43% of genotypes fall below a genotype quality of 30 and were converted to NA</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r.50k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/hard_filter.html">hard_filter</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.50K.vcf.gz"</span><span class="op">)</span>,depth <span class="op">=</span> <span class="fl">5</span>,gq <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 50000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 50000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 50000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant 16000
Processed variant 17000
Processed variant 18000
Processed variant 19000
Processed variant 20000
Processed variant 21000
Processed variant 22000
Processed variant 23000
Processed variant 24000
Processed variant 25000
Processed variant 26000
Processed variant 27000
Processed variant 28000
Processed variant 29000
Processed variant 30000
Processed variant 31000
Processed variant 32000
Processed variant 33000
Processed variant 34000
Processed variant 35000
Processed variant 36000
Processed variant 37000
Processed variant 38000
Processed variant 39000
Processed variant 40000
Processed variant 41000
Processed variant 42000
Processed variant 43000
Processed variant 44000
Processed variant 45000
Processed variant 46000
Processed variant 47000
Processed variant 48000
Processed variant 49000
Processed variant 50000
Processed variant: 50000
## All variants processed</code></pre>
<pre><code><span><span class="co">## 31.18% of genotypes fall below a read depth of 5 and were converted to NA</span></span></code></pre>
<pre><code><span><span class="co">## 1.37% of genotypes fall below a genotype quality of 30 and were converted to NA</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="filter-each-with-vcftools">Filter each with VCFtools<a class="anchor" aria-label="anchor" href="#filter-each-with-vcftools"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /Users/devder/Desktop/benchmarking.vcfs</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.10K.vcf.gz <span class="at">--minGQ</span> 30 <span class="at">--minDP</span> 5 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 10K.filtered</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.20K.vcf.gz <span class="at">--minGQ</span> 30 <span class="at">--minDP</span> 5 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 20K.filtered</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.50K.vcf.gz <span class="at">--minGQ</span> 30 <span class="at">--minDP</span> 5 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 50K.filtered</span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.10K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --minDP 5</span></span>
<span><span class="co">##  --minGQ 30</span></span>
<span><span class="co">##  --out 10K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 10000 out of a possible 10000 Sites</span></span>
<span><span class="co">## Run Time = 1.00 seconds</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.20K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --minDP 5</span></span>
<span><span class="co">##  --minGQ 30</span></span>
<span><span class="co">##  --out 20K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 20000 out of a possible 20000 Sites</span></span>
<span><span class="co">## Run Time = 2.00 seconds</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.50K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --minDP 5</span></span>
<span><span class="co">##  --minGQ 30</span></span>
<span><span class="co">##  --out 50K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 50000 out of a possible 50000 Sites</span></span>
<span><span class="co">## Run Time = 5.00 seconds</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="read-in-vcftools-files">Read in VCFtools files<a class="anchor" aria-label="anchor" href="#read-in-vcftools-files"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#read in all the vcftools files</span></span>
<span><span class="va">bash.10k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/10k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 10000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 10000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 10000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant: 10000
## All variants processed</code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bash.20k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/20k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 20000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 20000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 20000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant 16000
Processed variant 17000
Processed variant 18000
Processed variant 19000
Processed variant 20000
Processed variant: 20000
## All variants processed</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bash.50k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/50k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 50000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 50000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 50000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant 16000
Processed variant 17000
Processed variant 18000
Processed variant 19000
Processed variant 20000
Processed variant 21000
Processed variant 22000
Processed variant 23000
Processed variant 24000
Processed variant 25000
Processed variant 26000
Processed variant 27000
Processed variant 28000
Processed variant 29000
Processed variant 30000
Processed variant 31000
Processed variant 32000
Processed variant 33000
Processed variant 34000
Processed variant 35000
Processed variant 36000
Processed variant 37000
Processed variant 38000
Processed variant 39000
Processed variant 40000
Processed variant 41000
Processed variant 42000
Processed variant 43000
Processed variant 44000
Processed variant 45000
Processed variant 46000
Processed variant 47000
Processed variant 48000
Processed variant 49000
Processed variant 50000
Processed variant: 50000
## All variants processed</code></pre>
</div>
<div class="section level4">
<h4 id="check-that-every-cell-in-the-genotpye-matrix-matches-for-each-file">check that every cell in the genotpye matrix matches for each
file<a class="anchor" aria-label="anchor" href="#check-that-every-cell-in-the-genotpye-matrix-matches-for-each-file"></a>
</h4>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Does every cell in the genotype matrix for each camparable vcf match?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r.10k</span><span class="op">@</span><span class="va">gt</span> <span class="op">==</span> <span class="va">bash.10k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   TRUE </span></span>
<span><span class="co">## 127966</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r.20k</span><span class="op">@</span><span class="va">gt</span> <span class="op">==</span> <span class="va">bash.20k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   TRUE </span></span>
<span><span class="co">## 282173</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r.50k</span><span class="op">@</span><span class="va">gt</span> <span class="op">==</span> <span class="va">bash.50k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   TRUE </span></span>
<span><span class="co">## 664803</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="validate-the-missing_by_snp-function">Validate the missing_by_snp() function<a class="anchor" aria-label="anchor" href="#validate-the-missing_by_snp-function"></a>
</h2>
<div class="section level4">
<h4 id="filter-each-vcf-with-snpfiltr-1">Filter each vcf with SNPfiltR<a class="anchor" aria-label="anchor" href="#filter-each-vcf-with-snpfiltr-1"></a>
</h4>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#perform filtering on each vcf file and save the result</span></span>
<span><span class="va">r.10k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/missing_by_snp.html">missing_by_snp</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.10K.vcf.gz"</span><span class="op">)</span>,cutoff<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 10000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 10000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 10000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant: 10000
## All variants processed</code></pre>
<pre><code><span><span class="co">## cutoff is specified, filtered vcfR object will be returned</span></span></code></pre>
<pre><code><span><span class="co">## 85.65% of SNPs fell below a completeness cutoff of 0.5 and were removed from the VCF</span></span></code></pre>
<p><img src="accuracy-benchmarking_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r.20k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/missing_by_snp.html">missing_by_snp</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.20K.vcf.gz"</span><span class="op">)</span>,cutoff<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 20000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 20000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 20000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant 16000
Processed variant 17000
Processed variant 18000
Processed variant 19000
Processed variant 20000
Processed variant: 20000
## All variants processed</code></pre>
<pre><code><span><span class="co">## cutoff is specified, filtered vcfR object will be returned</span></span></code></pre>
<pre><code><span><span class="co">## 83.8% of SNPs fell below a completeness cutoff of 0.5 and were removed from the VCF</span></span></code></pre>
<p><img src="accuracy-benchmarking_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r.50k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/missing_by_snp.html">missing_by_snp</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.50K.vcf.gz"</span><span class="op">)</span>,cutoff<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 50000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 50000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 50000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant 16000
Processed variant 17000
Processed variant 18000
Processed variant 19000
Processed variant 20000
Processed variant 21000
Processed variant 22000
Processed variant 23000
Processed variant 24000
Processed variant 25000
Processed variant 26000
Processed variant 27000
Processed variant 28000
Processed variant 29000
Processed variant 30000
Processed variant 31000
Processed variant 32000
Processed variant 33000
Processed variant 34000
Processed variant 35000
Processed variant 36000
Processed variant 37000
Processed variant 38000
Processed variant 39000
Processed variant 40000
Processed variant 41000
Processed variant 42000
Processed variant 43000
Processed variant 44000
Processed variant 45000
Processed variant 46000
Processed variant 47000
Processed variant 48000
Processed variant 49000
Processed variant 50000
Processed variant: 50000
## All variants processed</code></pre>
<pre><code><span><span class="co">## cutoff is specified, filtered vcfR object will be returned</span></span></code></pre>
<pre><code><span><span class="co">## 84.44% of SNPs fell below a completeness cutoff of 0.5 and were removed from the VCF</span></span></code></pre>
<p><img src="accuracy-benchmarking_files/figure-html/unnamed-chunk-6-3.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="filter-each-with-vcftools-1">Filter each with VCFtools<a class="anchor" aria-label="anchor" href="#filter-each-with-vcftools-1"></a>
</h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /Users/devder/Desktop/benchmarking.vcfs</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.10K.vcf.gz <span class="at">--max-missing</span> 0.5 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 10K.filtered</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.20K.vcf.gz <span class="at">--max-missing</span> 0.5 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 20K.filtered</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.50K.vcf.gz <span class="at">--max-missing</span> 0.5 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 50K.filtered</span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.10K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --max-missing 0.5</span></span>
<span><span class="co">##  --out 10K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 1435 out of a possible 10000 Sites</span></span>
<span><span class="co">## Run Time = 1.00 seconds</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.20K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --max-missing 0.5</span></span>
<span><span class="co">##  --out 20K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 3241 out of a possible 20000 Sites</span></span>
<span><span class="co">## Run Time = 1.00 seconds</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.50K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --max-missing 0.5</span></span>
<span><span class="co">##  --out 50K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 7782 out of a possible 50000 Sites</span></span>
<span><span class="co">## Run Time = 2.00 seconds</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="read-in-vcftools-files-1">Read in VCFtools files<a class="anchor" aria-label="anchor" href="#read-in-vcftools-files-1"></a>
</h4>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#read in all the vcftools files</span></span>
<span><span class="va">bash.10k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/10k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 1435
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 1435
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 1435
##   row_num: 0
## 
Processed variant 1000
Processed variant: 1435
## All variants processed</code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bash.20k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/20k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 3241
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 3241
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 3241
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant: 3241
## All variants processed</code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bash.50k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/50k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 7782
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 7782
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 7782
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant: 7782
## All variants processed</code></pre>
</div>
<div class="section level4">
<h4 id="check-that-every-cell-in-the-genotpye-matrix-matches-for-each-file-1">check that every cell in the genotpye matrix matches for each
file<a class="anchor" aria-label="anchor" href="#check-that-every-cell-in-the-genotpye-matrix-matches-for-each-file-1"></a>
</h4>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Does every cell in the genotype matrix for each camparable vcf match?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r.10k</span><span class="op">@</span><span class="va">gt</span> <span class="op">==</span> <span class="va">bash.10k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   TRUE </span></span>
<span><span class="co">## 122778</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r.20k</span><span class="op">@</span><span class="va">gt</span> <span class="op">==</span> <span class="va">bash.20k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   TRUE </span></span>
<span><span class="co">## 277322</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r.50k</span><span class="op">@</span><span class="va">gt</span> <span class="op">==</span> <span class="va">bash.50k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   TRUE </span></span>
<span><span class="co">## 652933</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="validate-the-min_mac-function">Validate the min_mac() function<a class="anchor" aria-label="anchor" href="#validate-the-min_mac-function"></a>
</h2>
<div class="section level4">
<h4 id="filter-each-vcf-with-snpfiltr-2">Filter each vcf with SNPfiltR<a class="anchor" aria-label="anchor" href="#filter-each-vcf-with-snpfiltr-2"></a>
</h4>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#perform filtering on each vcf file and save the result</span></span>
<span><span class="va">r.10k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/min_mac.html">min_mac</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.10K.vcf.gz"</span><span class="op">)</span>,min.mac <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 10000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 10000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 10000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant: 10000
## All variants processed</code></pre>
<pre><code><span><span class="co">## 59.1% of SNPs fell below a minor allele count of 2 and were removed from the VCF</span></span></code></pre>
<p><img src="accuracy-benchmarking_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r.20k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/min_mac.html">min_mac</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.20K.vcf.gz"</span><span class="op">)</span>,min.mac <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 20000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 20000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 20000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant 16000
Processed variant 17000
Processed variant 18000
Processed variant 19000
Processed variant 20000
Processed variant: 20000
## All variants processed</code></pre>
<pre><code><span><span class="co">## 58.26% of SNPs fell below a minor allele count of 2 and were removed from the VCF</span></span></code></pre>
<p><img src="accuracy-benchmarking_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r.50k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/min_mac.html">min_mac</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.50K.vcf.gz"</span><span class="op">)</span>,min.mac <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 50000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 50000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 50000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant 16000
Processed variant 17000
Processed variant 18000
Processed variant 19000
Processed variant 20000
Processed variant 21000
Processed variant 22000
Processed variant 23000
Processed variant 24000
Processed variant 25000
Processed variant 26000
Processed variant 27000
Processed variant 28000
Processed variant 29000
Processed variant 30000
Processed variant 31000
Processed variant 32000
Processed variant 33000
Processed variant 34000
Processed variant 35000
Processed variant 36000
Processed variant 37000
Processed variant 38000
Processed variant 39000
Processed variant 40000
Processed variant 41000
Processed variant 42000
Processed variant 43000
Processed variant 44000
Processed variant 45000
Processed variant 46000
Processed variant 47000
Processed variant 48000
Processed variant 49000
Processed variant 50000
Processed variant: 50000
## All variants processed</code></pre>
<pre><code><span><span class="co">## 57.94% of SNPs fell below a minor allele count of 2 and were removed from the VCF</span></span></code></pre>
<p><img src="accuracy-benchmarking_files/figure-html/unnamed-chunk-10-3.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="filter-each-with-vcftools-2">Filter each with VCFtools<a class="anchor" aria-label="anchor" href="#filter-each-with-vcftools-2"></a>
</h4>
<div class="sourceCode" id="cb67"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /Users/devder/Desktop/benchmarking.vcfs</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.10K.vcf.gz <span class="at">--mac</span> 2 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 10K.filtered</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.20K.vcf.gz <span class="at">--mac</span> 2 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 20K.filtered</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.50K.vcf.gz <span class="at">--mac</span> 2 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 50K.filtered</span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.10K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --mac 2</span></span>
<span><span class="co">##  --out 10K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 4090 out of a possible 10000 Sites</span></span>
<span><span class="co">## Run Time = 1.00 seconds</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.20K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --mac 2</span></span>
<span><span class="co">##  --out 20K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 8348 out of a possible 20000 Sites</span></span>
<span><span class="co">## Run Time = 1.00 seconds</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.50K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --mac 2</span></span>
<span><span class="co">##  --out 50K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 21031 out of a possible 50000 Sites</span></span>
<span><span class="co">## Run Time = 3.00 seconds</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="read-in-vcftools-files-2">Read in VCFtools files<a class="anchor" aria-label="anchor" href="#read-in-vcftools-files-2"></a>
</h4>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#read in all the vcftools files</span></span>
<span><span class="va">bash.10k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/10k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 4090
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 4090
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 4090
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant: 4090
## All variants processed</code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bash.20k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/20k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 8348
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 8348
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 8348
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant: 8348
## All variants processed</code></pre>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bash.50k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/50k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 21031
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 21031
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 21031
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant 16000
Processed variant 17000
Processed variant 18000
Processed variant 19000
Processed variant 20000
Processed variant 21000
Processed variant: 21031
## All variants processed</code></pre>
</div>
<div class="section level4">
<h4 id="check-that-every-cell-in-the-genotpye-matrix-matches-for-each-file-2">check that every cell in the genotpye matrix matches for each
file<a class="anchor" aria-label="anchor" href="#check-that-every-cell-in-the-genotpye-matrix-matches-for-each-file-2"></a>
</h4>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Does every cell in the genotype matrix for each camparable vcf match?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r.10k</span><span class="op">@</span><span class="va">gt</span> <span class="op">==</span> <span class="va">bash.10k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   TRUE </span></span>
<span><span class="co">## 107663</span></span></code></pre>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r.20k</span><span class="op">@</span><span class="va">gt</span> <span class="op">==</span> <span class="va">bash.20k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   TRUE </span></span>
<span><span class="co">## 231584</span></span></code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">r.50k</span><span class="op">@</span><span class="va">gt</span> <span class="op">==</span> <span class="va">bash.50k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   TRUE </span></span>
<span><span class="co">## 554511</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="validate-the-distance_thin-function">Validate the distance_thin() function<a class="anchor" aria-label="anchor" href="#validate-the-distance_thin-function"></a>
</h2>
<div class="section level4">
<h4 id="filter-each-vcf-with-snpfiltr-3">Filter each vcf with SNPfiltR<a class="anchor" aria-label="anchor" href="#filter-each-vcf-with-snpfiltr-3"></a>
</h4>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#perform filtering on each vcf file and save the result</span></span>
<span><span class="va">r.10k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/distance_thin.html">distance_thin</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.10K.vcf.gz"</span><span class="op">)</span>,min.distance<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 10000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 10000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 10000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant: 10000
## All variants processed</code></pre>
<pre><code><span><span class="co">## 68 duplicated SNPs removed from input vcf</span></span></code></pre>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<pre><code><span><span class="co">## 2789 out of 9932 input SNPs were not located within 100 base-pairs of another SNP and were retained despite filtering</span></span></code></pre>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r.20k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/distance_thin.html">distance_thin</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.20K.vcf.gz"</span><span class="op">)</span>,min.distance<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 20000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 20000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 20000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant 16000
Processed variant 17000
Processed variant 18000
Processed variant 19000
Processed variant 20000
Processed variant: 20000
## All variants processed</code></pre>
<pre><code><span><span class="co">## 143 duplicated SNPs removed from input vcf</span></span></code></pre>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |======================================================================| 100%</code></pre>
<pre><code><span><span class="co">## 5608 out of 19857 input SNPs were not located within 100 base-pairs of another SNP and were retained despite filtering</span></span></code></pre>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r.50k</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/distance_thin.html">distance_thin</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/benchmark.50K.vcf.gz"</span><span class="op">)</span>,min.distance<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 50000
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 50000
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 50000
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant 13000
Processed variant 14000
Processed variant 15000
Processed variant 16000
Processed variant 17000
Processed variant 18000
Processed variant 19000
Processed variant 20000
Processed variant 21000
Processed variant 22000
Processed variant 23000
Processed variant 24000
Processed variant 25000
Processed variant 26000
Processed variant 27000
Processed variant 28000
Processed variant 29000
Processed variant 30000
Processed variant 31000
Processed variant 32000
Processed variant 33000
Processed variant 34000
Processed variant 35000
Processed variant 36000
Processed variant 37000
Processed variant 38000
Processed variant 39000
Processed variant 40000
Processed variant 41000
Processed variant 42000
Processed variant 43000
Processed variant 44000
Processed variant 45000
Processed variant 46000
Processed variant 47000
Processed variant 48000
Processed variant 49000
Processed variant 50000
Processed variant: 50000
## All variants processed</code></pre>
<pre><code><span><span class="co">## 364 duplicated SNPs removed from input vcf</span></span></code></pre>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |======================================================================| 100%</code></pre>
<pre><code><span><span class="co">## 14439 out of 49636 input SNPs were not located within 100 base-pairs of another SNP and were retained despite filtering</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="filter-each-with-vcftools-3">Filter each with VCFtools<a class="anchor" aria-label="anchor" href="#filter-each-with-vcftools-3"></a>
</h4>
<div class="sourceCode" id="cb96"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /Users/devder/Desktop/benchmarking.vcfs</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.10K.vcf.gz <span class="at">--thin</span> 100 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 10K.filtered</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.20K.vcf.gz <span class="at">--thin</span> 100 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 20K.filtered</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/devder/Downloads/vcftools/src/cpp/vcftools</span> <span class="at">--gzvcf</span> benchmark.50K.vcf.gz <span class="at">--thin</span> 100 <span class="at">--recode</span> <span class="at">--recode-INFO-all</span> <span class="at">--out</span> 50K.filtered</span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.10K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --thin 100</span></span>
<span><span class="co">##  --out 10K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 2408 out of a possible 10000 Sites</span></span>
<span><span class="co">## Run Time = 1.00 seconds</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.20K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --thin 100</span></span>
<span><span class="co">##  --out 20K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 4826 out of a possible 20000 Sites</span></span>
<span><span class="co">## Run Time = 0.00 seconds</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## VCFtools - 0.1.17</span></span>
<span><span class="co">## (C) Adam Auton and Anthony Marcketta 2009</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters as interpreted:</span></span>
<span><span class="co">##  --gzvcf benchmark.50K.vcf.gz</span></span>
<span><span class="co">##  --recode-INFO-all</span></span>
<span><span class="co">##  --thin 100</span></span>
<span><span class="co">##  --out 50K.filtered</span></span>
<span><span class="co">##  --recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Using zlib version: 1.2.11</span></span>
<span><span class="co">## After filtering, kept 100 out of 100 Individuals</span></span>
<span><span class="co">## Outputting VCF file...</span></span>
<span><span class="co">## After filtering, kept 12541 out of a possible 50000 Sites</span></span>
<span><span class="co">## Run Time = 1.00 seconds</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="read-in-vcftools-files-3">Read in VCFtools files<a class="anchor" aria-label="anchor" href="#read-in-vcftools-files-3"></a>
</h4>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#read in all the vcftools files</span></span>
<span><span class="va">bash.10k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/10k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 2408
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 2408
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 2408
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant: 2408
## All variants processed</code></pre>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bash.20k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/20k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 4826
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 4826
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 4826
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant: 4826
## All variants processed</code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bash.50k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html" class="external-link">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Desktop/benchmarking.vcfs/50k.filtered.recode.vcf"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 14
##   header_line: 15
##   variant count: 12541
##   column count: 109
## 
Meta line 14 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 12541
##   Character matrix gt cols: 109
##   skip: 0
##   nrows: 12541
##   row_num: 0
## 
Processed variant 1000
Processed variant 2000
Processed variant 3000
Processed variant 4000
Processed variant 5000
Processed variant 6000
Processed variant 7000
Processed variant 8000
Processed variant 9000
Processed variant 10000
Processed variant 11000
Processed variant 12000
Processed variant: 12541
## All variants processed</code></pre>
</div>
<div class="section level4">
<h4 id="check-that-every-cell-in-the-genotpye-matrix-matches-for-each-file-3">check that every cell in the genotpye matrix matches for each
file<a class="anchor" aria-label="anchor" href="#check-that-every-cell-in-the-genotpye-matrix-matches-for-each-file-3"></a>
</h4>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Does every cell in the genotype matrix for each camparable vcf match?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">r.10k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2789  101</span></span></code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bash.10k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2408  101</span></span></code></pre>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">r.20k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5608  101</span></span></code></pre>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bash.20k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4826  101</span></span></code></pre>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">r.50k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 14439   101</span></span></code></pre>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bash.50k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 12541   101</span></span></code></pre>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#right away we can see that the dimensions of these vcf files don't match, indicating that the results differ.</span></span>
<span></span>
<span><span class="co">#Let's calculate distance between SNPs in each vcf by hand to make sure both methods work as promised.</span></span>
<span></span>
<span><span class="co">### Start with SNPfiltR thinned vcf:</span></span>
<span><span class="co">##</span></span>
<span><span class="co">#</span></span>
<span></span>
<span><span class="co">#generate dataframe containing information for chromosome and bp locality of each SNP</span></span>
<span><span class="va">df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">r.10k</span><span class="op">@</span><span class="va">fix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#generate list of all unique chromosomes in alphabetical order</span></span>
<span><span class="va">chroms</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">CHROM</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#intialize empty df to hold filtering</span></span>
<span><span class="va">keep.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#loop over each chromosome</span></span>
<span><span class="co">#for t in vector containing the name of each chromosome</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="va">chroms</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="co">#isolate the SNP positions on the given chromosome</span></span>
<span>  <span class="va">fix.sub</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">POS</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">CHROM</span> <span class="op">==</span> <span class="va">t</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">#order the positions numerically</span></span>
<span>  <span class="va">fix.sub</span><span class="op">&lt;-</span><span class="va">fix.sub</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">fix.sub</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co">#set the first position</span></span>
<span>  <span class="va">prev</span><span class="op">&lt;-</span><span class="va">fix.sub</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co">#initialize empty vector</span></span>
<span>  <span class="va">k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">k</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="cn">NA</span></span>
<span>  </span>
<span>  <span class="co">#loop to decide whether to keep each following SNP</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fix.sub</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="co">#if chrom only has 1 SNP, do nothing</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span></span>
<span>      <span class="co">#else, use a for loop to determine which SNPs to keep that satisfy our distance criteria</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fix.sub</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>        <span class="co">#store distance in base pairs of the current SNP from the previous SNP</span></span>
<span>        <span class="va">k</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">fix.sub</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">prev</span></span>
<span></span>
<span>        <span class="co">#update the current SNP to be the previous SNP for the next iteration of this loop</span></span>
<span>        <span class="va">prev</span><span class="op">&lt;-</span><span class="va">fix.sub</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>        </span>
<span>      <span class="co">#close for loop</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="co">#k[1]&lt;- fix.sub[2] - fix.sub[1]</span></span>
<span>    <span class="co">#close else statement</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>  <span class="co">#make a dataframe with the precise info for each SNP for this chromosome</span></span>
<span>  <span class="va">chrom.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>CHROM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">t</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fix.sub</span><span class="op">)</span><span class="op">)</span>, POS<span class="op">=</span><span class="va">fix.sub</span>, dist<span class="op">=</span><span class="va">k</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">#now we rbind in the information for this chromosome to the overall df</span></span>
<span>  <span class="va">keep.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">keep.df</span>,<span class="va">chrom.df</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">#empty df for this chrom to prepare for the next one</span></span>
<span>  <span class="va">chrom.df</span><span class="op">&lt;-</span><span class="cn">NULL</span></span>
<span></span>
<span><span class="op">}</span> <span class="co">#close for loop, start over on next chromosome</span></span>
<span></span>
<span><span class="co">#order the dataframe to match the order of the input vcf file</span></span>
<span><span class="va">order.df</span><span class="op">&lt;-</span><span class="va">keep.df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">CHROM</span>,<span class="va">df</span><span class="op">$</span><span class="va">POS</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">keep.df</span><span class="op">$</span><span class="va">CHROM</span>,<span class="va">keep.df</span><span class="op">$</span><span class="va">POS</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">order.df</span><span class="op">&lt;-</span><span class="va">order.df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">order.df</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">#show the lower distribution of SNP distances to see if any fall below the 100bp threshold</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">order.df</span><span class="op">$</span><span class="va">dist</span>, xlim <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1000</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fl">50000</span>, main <span class="op">=</span> <span class="st">"thinning using SNPfiltR"</span>,</span>
<span>          xlab <span class="op">=</span> <span class="st">"Distance from nearest SNP (base pairs)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">100</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="accuracy-benchmarking_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/vcfR-method.html" class="external-link">head</a></span><span class="op">(</span><span class="va">order.df</span><span class="op">)</span> <span class="co">#show the tail of SNP distances</span></span></code></pre></div>
<pre><code><span><span class="co">##            CHROM     POS dist</span></span>
<span><span class="co">## 220 Pseudo10_dna 2854287  101</span></span>
<span><span class="co">## 331 Pseudo10_dna 3419169  101</span></span>
<span><span class="co">## 333 Pseudo10_dna 3420934  101</span></span>
<span><span class="co">## 467 Pseudo10_dna 4224139  101</span></span>
<span><span class="co">## 469 Pseudo10_dna 4224491  101</span></span>
<span><span class="co">## 532 Pseudo10_dna 4498157  101</span></span></code></pre>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#store df</span></span>
<span><span class="va">snpfilt.df</span><span class="op">&lt;-</span><span class="va">order.df</span></span>
<span></span>
<span><span class="co">### repeat for the VCFtools filtered vcf</span></span>
<span><span class="co">##</span></span>
<span><span class="co">#</span></span>
<span></span>
<span><span class="co">#generate dataframe containing information for chromosome and bp locality of each SNP</span></span>
<span><span class="va">df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">bash.10k</span><span class="op">@</span><span class="va">fix</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#generate list of all unique chromosomes in alphabetical order</span></span>
<span><span class="va">chroms</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">CHROM</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#intialize empty df to hold filtering</span></span>
<span><span class="va">keep.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#loop over each chromosome</span></span>
<span><span class="co">#for t in vector containing the name of each chromosome</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="va">chroms</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="co">#isolate the SNP positions on the given chromosome</span></span>
<span>  <span class="va">fix.sub</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">POS</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">CHROM</span> <span class="op">==</span> <span class="va">t</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">#order the positions numerically</span></span>
<span>  <span class="va">fix.sub</span><span class="op">&lt;-</span><span class="va">fix.sub</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">fix.sub</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co">#set the first position</span></span>
<span>  <span class="va">prev</span><span class="op">&lt;-</span><span class="va">fix.sub</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co">#initialize empty vector</span></span>
<span>  <span class="va">k</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">k</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="cn">NA</span></span>
<span>  </span>
<span>  <span class="co">#loop to decide whether to keep each following SNP</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fix.sub</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="co">#if chrom only has 1 SNP, do nothing</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span></span>
<span>      <span class="co">#else, use a for loop to determine which SNPs to keep that satisfy our distance criteria</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fix.sub</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>        <span class="co">#store distance in base pairs of the current SNP from the previous SNP</span></span>
<span>        <span class="va">k</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">fix.sub</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">prev</span></span>
<span></span>
<span>        <span class="co">#update the current SNP to be the previous SNP for the next iteration of this loop</span></span>
<span>        <span class="va">prev</span><span class="op">&lt;-</span><span class="va">fix.sub</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>        </span>
<span>      <span class="co">#close for loop</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="co">#k[1]&lt;- fix.sub[2] - fix.sub[1]</span></span>
<span>    <span class="co">#close else statement</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>  <span class="co">#make a dataframe with the precise info for each SNP for this chromosome</span></span>
<span>  <span class="va">chrom.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>CHROM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">t</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fix.sub</span><span class="op">)</span><span class="op">)</span>, POS<span class="op">=</span><span class="va">fix.sub</span>, dist<span class="op">=</span><span class="va">k</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">#now we rbind in the information for this chromosome to the overall df</span></span>
<span>  <span class="va">keep.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">keep.df</span>,<span class="va">chrom.df</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">#empty df for this chrom to prepare for the next one</span></span>
<span>  <span class="va">chrom.df</span><span class="op">&lt;-</span><span class="cn">NULL</span></span>
<span></span>
<span><span class="op">}</span> <span class="co">#close for loop, start over on next chromosome</span></span>
<span></span>
<span><span class="co">#order the dataframe to match the order of the input vcf file</span></span>
<span><span class="va">order.df</span><span class="op">&lt;-</span><span class="va">keep.df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">CHROM</span>,<span class="va">df</span><span class="op">$</span><span class="va">POS</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">keep.df</span><span class="op">$</span><span class="va">CHROM</span>,<span class="va">keep.df</span><span class="op">$</span><span class="va">POS</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">order.df</span><span class="op">&lt;-</span><span class="va">order.df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">order.df</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">order.df</span><span class="op">$</span><span class="va">dist</span>, xlim <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1000</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fl">50000</span>, main <span class="op">=</span> <span class="st">"thinning using VCFtools"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Distance from nearest SNP (base pairs)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">100</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="accuracy-benchmarking_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/vcfR-method.html" class="external-link">head</a></span><span class="op">(</span><span class="va">order.df</span><span class="op">)</span> <span class="co">#show the tail of SNP distances</span></span></code></pre></div>
<pre><code><span><span class="co">##             CHROM      POS dist</span></span>
<span><span class="co">## 2197 Pseudo10_dna 16289157  100</span></span>
<span><span class="co">## 464  Pseudo10_dna  4498157  101</span></span>
<span><span class="co">## 2257 Pseudo10_dna 16585988  101</span></span>
<span><span class="co">## 163  Pseudo10_dna  2575297  102</span></span>
<span><span class="co">## 1834 Pseudo10_dna 13584214  102</span></span>
<span><span class="co">## 848  Pseudo10_dna  6642570  103</span></span></code></pre>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#putting the dataframe in chromosomal order, we can see right away that SNPs less than 100bp apart have been retained</span></span>
<span><span class="va">order.df</span><span class="op">&lt;-</span><span class="va">order.df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">order.df</span>, <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">CHROM</span>, <span class="va">POS</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">order.df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##           CHROM    POS  dist</span></span>
<span><span class="co">## 1  Pseudo10_dna  25891    NA</span></span>
<span><span class="co">## 2  Pseudo10_dna  31885  5994</span></span>
<span><span class="co">## 3  Pseudo10_dna  85182 53297</span></span>
<span><span class="co">## 4  Pseudo10_dna 135731 50549</span></span>
<span><span class="co">## 5  Pseudo10_dna 156488 20757</span></span>
<span><span class="co">## 6  Pseudo10_dna 163096  6608</span></span>
<span><span class="co">## 7  Pseudo10_dna 178396 15300</span></span>
<span><span class="co">## 8  Pseudo10_dna 185542  7146</span></span>
<span><span class="co">## 9  Pseudo10_dna 225731 40189</span></span>
<span><span class="co">## 10 Pseudo10_dna 228849  3118</span></span></code></pre>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#plot the two together on the same histogram</span></span>
<span><span class="va">order.df</span><span class="op">$</span><span class="va">approach</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"VCFtools"</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">order.df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">snpfilt.df</span><span class="op">$</span><span class="va">approach</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"SNPfiltR"</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">snpfilt.df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sum.df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">order.df</span>,<span class="va">snpfilt.df</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#plot both</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sum.df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">dist</span>, color<span class="op">=</span><span class="va">approach</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins<span class="op">=</span><span class="fl">100</span>, fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Distance from nearest SNP (base pairs)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">100</span>, linetype<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 3756 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 4 rows containing missing values (`geom_bar()`).</span></span></code></pre>
<p><img src="accuracy-benchmarking_files/figure-html/unnamed-chunk-17-3.png" width="700"></p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hists</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sum.df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">dist</span>, color<span class="op">=</span><span class="va">approach</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins<span class="op">=</span><span class="fl">100</span>, fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2500</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Distance from nearest SNP (base pairs)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">100</span>, linetype<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#save plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="va">hists</span>,</span>
<span>      filename <span class="op">=</span> <span class="st">"~/Desktop/SNPfiltR.mol.ecol.resour.submission/resubmission/validate.thinning.pdf"</span>,</span>
<span>      height <span class="op">=</span> <span class="fl">2</span>, width <span class="op">=</span> <span class="fl">8</span>, units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 3061 rows containing non-finite values (`stat_bin()`).</span></span>
<span><span class="co">## Removed 4 rows containing missing values (`geom_bar()`).</span></span></code></pre>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#see how many retained SNPs overlap between the two approaches for each file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">r.10k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">bash.10k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##  1212  1577</span></span></code></pre>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">r.20k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">bash.20k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##  2440  3168</span></span></code></pre>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">r.50k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">bash.50k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##  6154  8285</span></span></code></pre>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#store number of SNPs for each approach as a vector</span></span>
<span><span class="va">r.snps</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">r.snps</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">r.10k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span>
<span><span class="va">r.snps</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">r.20k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span>
<span><span class="va">r.snps</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">r.50k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#store number of bash SNPs</span></span>
<span><span class="va">bash.snps</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bash.snps</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bash.10k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span>
<span><span class="va">bash.snps</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bash.20k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span>
<span><span class="va">bash.snps</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bash.50k</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bar.frame</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>snps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r.snps</span>,<span class="va">bash.snps</span><span class="op">)</span>,</span>
<span>                      approach<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNPfiltR::distance_thin()"</span>,<span class="st">"SNPfiltR::distance_thin()"</span>,<span class="st">"SNPfiltR::distance_thin()"</span>,</span>
<span>                               <span class="st">"VCFtools --thin"</span>,<span class="st">"VCFtools --thin"</span>,<span class="st">"VCFtools --thin"</span><span class="op">)</span>,</span>
<span>                      input.snps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10K"</span>,<span class="st">"20K"</span>,<span class="st">"50K"</span>,</span>
<span>                                   <span class="st">"10K"</span>,<span class="st">"20K"</span>,<span class="st">"50K"</span><span class="op">)</span></span>
<span>                      <span class="op">)</span></span>
<span></span>
<span><span class="co">## Grouped bar plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bar.frame</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">approach</span>, y<span class="op">=</span><span class="va">snps</span>, x<span class="op">=</span><span class="va">input.snps</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"dodge"</span>, stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"SNPs in input vcf file"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Number of thinned SNPs"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="accuracy-benchmarking_files/figure-html/unnamed-chunk-17-4.png" width="700"></p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thin.bar</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bar.frame</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">approach</span>, y<span class="op">=</span><span class="va">snps</span>, x<span class="op">=</span><span class="va">input.snps</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"dodge"</span>, stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"SNPs in input vcf file"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Number of thinned SNPs"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#save plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="va">thin.bar</span>,</span>
<span>      filename <span class="op">=</span> <span class="st">"~/Desktop/SNPfiltR.mol.ecol.resour.submission/resubmission/thinning.comp.pdf"</span>,</span>
<span>      height <span class="op">=</span> <span class="fl">3</span>, width <span class="op">=</span> <span class="fl">4.5</span>, units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="make-final-table-showing-genotpye-concordance-across-comparisons">Make final table showing genotpye concordance across
comparisons<a class="anchor" aria-label="anchor" href="#make-final-table-showing-genotpye-concordance-across-comparisons"></a>
</h4>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print table showing concordance</span></span>
<span><span class="va">concord</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>concordance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">r.10k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">bash.10k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">r.10k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">r.20k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">bash.20k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">r.20k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">r.50k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">bash.50k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">CHROM</span>,<span class="va">POS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">r.50k</span><span class="op">@</span><span class="va">fix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      filtering<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GQ"</span>,<span class="st">"GQ"</span>,<span class="st">"GQ"</span>,<span class="st">"missing data"</span>,<span class="st">"missing data"</span>,<span class="st">"missing data"</span>,</span>
<span>                                  <span class="st">"MAC"</span>,<span class="st">"MAC"</span>,<span class="st">"MAC"</span>,<span class="st">"distance thin"</span>,<span class="st">"distance thin"</span>,<span class="st">"distance thin"</span><span class="op">)</span>,</span>
<span>                      input.snps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10K"</span>,<span class="st">"20K"</span>,<span class="st">"50K"</span>,</span>
<span>                                   <span class="st">"10K"</span>,<span class="st">"20K"</span>,<span class="st">"50K"</span>,</span>
<span>                                   <span class="st">"10K"</span>,<span class="st">"20K"</span>,<span class="st">"50K"</span>,</span>
<span>                                   <span class="st">"10K"</span>,<span class="st">"20K"</span>,<span class="st">"50K"</span><span class="op">)</span></span>
<span>                      <span class="op">)</span></span>
<span></span>
<span><span class="co">#print table</span></span>
<span><span class="va">heat</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">concord</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using filtering, input.snps as id variables</span></span></code></pre>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">heat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">input.snps</span>, y<span class="op">=</span><span class="va">filtering</span>, fill<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">heat</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"cornflowerblue"</span>, space <span class="op">=</span> <span class="st">"Lab"</span>, name<span class="op">=</span><span class="st">"genotype\nconcordance"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"type of filtering"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Number of SNPs in input vcf file"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="accuracy-benchmarking_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geno.concord.plot</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">heat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">input.snps</span>, y<span class="op">=</span><span class="va">filtering</span>, fill<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">heat</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"cornflowerblue"</span>, space <span class="op">=</span> <span class="st">"Lab"</span>, name<span class="op">=</span><span class="st">"genotype\nconcordance"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"type of filtering"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Number of SNPs in input vcf file"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#save plot</span></span>
<span><span class="co">#ggsave(geno.concord.plot,</span></span>
<span><span class="co">#      filename = "~/Desktop/SNPfiltR.mol.ecol.resour.submission/resubmission/geno.concord.pdf",</span></span>
<span><span class="co">#      height = 3, width = 5, units = "in")</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Devon DeRaad.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
