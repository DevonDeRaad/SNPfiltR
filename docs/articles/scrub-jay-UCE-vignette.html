<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>scrub-jay-UCE-vignette • SNPfiltR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="scrub-jay-UCE-vignette">
<meta property="og:description" content="SNPfiltR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SNPfiltR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/reproducible-vignette.html">reproducible-vignette</a>
    </li>
    <li>
      <a href="../articles/scrub-jay-RADseq-vignette.html">scrub-jay-RADseq-vignette</a>
    </li>
    <li>
      <a href="../articles/scrub-jay-UCE-vignette.html">scrub-jay-UCE-vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="scrub-jay-UCE-vignette_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>scrub-jay-UCE-vignette</h1>
            
      
      
      <div class="hidden name"><code>scrub-jay-UCE-vignette.Rmd</code></div>

    </div>

    
    
<p>This is an example of filtering SNPs derived from sequencing UCE’s (<a href="https://www.ultraconserved.org/">ultra-conserved elements</a>) for 28 bird toe-pad samples. This filtering example starts with the unfiltered vcf file that I downloaded from the publicly available repository associated with the paper <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/1755-0998.12466">Sequence capture of ultraconserved elements from bird museum specimens</a>. This small next-generation dataset can be easily handled in Rstudio on a personal laptop, and is ideal for showing off the interactive functionality of SNPfiltR. Because these samples come from degraded DNA (avian toepads), and contain varying levels of contamination (according to the paper) they are also ideal for showing the necessity of stringent filtering protocols both by sample and by SNP.</p>
<div id="optional-step-0-per-sample-quality-control" class="section level1">
<h1 class="hasAnchor">
<a href="#optional-step-0-per-sample-quality-control" class="anchor"></a>Optional Step 0: per sample quality control</h1>
<p>Do quality control per sample before performing SNP calling. I have written an <a href="https://github.com/DevonDeRaad/RADstackshelpR/blob/master/inst/extdata/fastqcr.Rmd">RMarkdown script</a> that uses the R package <a href="https://github.com/kassambara/fastqcr">fastqcr</a> to generate a report visualizing the quality and quantity of sequencing for each sample, and recommending a subset of samples to be immediately dropped before parameter optimization (specifically useful for RADseq data). The only modification necessary for this script is the path to the folder containing the input .fastq.gz files and the path to your desired output folder. An example report generated using this script can be seen <a href="https://devonderaad.github.io/RADstackshelpR/articles/quality.control.vignette.html">here</a>. Because the fastq.gz files for your experiment may be large and handled remotely, an example bash script for executing this RMarkdown file as a job on a high performance computing cluster is available <a href="https://github.com/DevonDeRaad/RADstackshelpR/blob/master/inst/extdata/RMarkdown.qc.submit.script.sh">here</a>.</p>
<div id="because-i-downloaded-this-publicly-available-vcf-i-was-unable-to-perform-quality-control-before-assembly--this-is-no-problem-because-we-can-effectively-perform-sample-quality-control-here-in-r-using-snpfiltr--i-started-by-reading-in-the-vcf-file-using-the-vcfr-package" class="section level4">
<h4 class="hasAnchor">
<a href="#because-i-downloaded-this-publicly-available-vcf-i-was-unable-to-perform-quality-control-before-assembly--this-is-no-problem-because-we-can-effectively-perform-sample-quality-control-here-in-r-using-snpfiltr--i-started-by-reading-in-the-vcf-file-using-the-vcfr-package" class="anchor"></a>Because I downloaded this publicly available vcf, I was unable to perform quality control before assembly. This is no problem, because we can effectively perform sample quality control here in R using SNPfiltR. I started by reading in the vcf file using the vcfR package:</h4>
</div>
</div>
<div id="step-1-read-in-vcf-file-as-vcfr-object" class="section level1">
<h1 class="hasAnchor">
<a href="#step-1-read-in-vcf-file-as-vcfr-object" class="anchor"></a>Step 1: read in vcf file as ‘vcfR’ object</h1>
<div id="read-in-vcf-file-using-vcfr" class="section level3">
<h3 class="hasAnchor">
<a href="#read-in-vcf-file-using-vcfr" class="anchor"></a>Read in vcf file using <a href="https://knausb.github.io/vcfR_documentation/">vcfR</a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">SNPfiltR</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/knausb/vcfR">vcfR</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    *****       ***   vcfR   ***       *****</span>
<span class="co">#&gt;    This is vcfR 1.12.0 </span>
<span class="co">#&gt;      browseVignettes('vcfR') # Documentation</span>
<span class="co">#&gt;      citation('vcfR') # Citation</span>
<span class="co">#&gt;    *****       *****      *****       *****</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#read in vcf as vcfR</span>
<span class="va">vcfR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/io_vcfR.html">read.vcfR</a></span><span class="op">(</span><span class="st">"~/Downloads/doi_10.5061_dryad.qh8sh__v1/wesj-toepads-rawSNPS-Q30.vcf"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#check out metadata for the vcf file</span>
<span class="va">vcfR</span>
<span class="co">#&gt; ***** Object of Class vcfR *****</span>
<span class="co">#&gt; 28 samples</span>
<span class="co">#&gt; 4524 CHROMs</span>
<span class="co">#&gt; 44,490 variants</span>
<span class="co">#&gt; Object size: 40.2 Mb</span>
<span class="co">#&gt; 31.02 percent missing data</span>
<span class="co">#&gt; *****        *****         *****</span>

<span class="co">#generate popmap file. Two column popmap with the same format as stacks, and the columns must be named 'id' and 'pop'</span>
<span class="va">popmap</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">vcfR</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">vcfR</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,pop<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">vcfR</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">vcfR</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, <span class="fl">3</span>,<span class="fl">11</span><span class="op">)</span><span class="op">)</span>
<span class="va">popmap</span><span class="op">$</span><span class="va">pop</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ca"</span>,<span class="st">"wood"</span>,<span class="st">"ca"</span>,<span class="st">"ca"</span>,<span class="st">"ca"</span>,<span class="st">"wood"</span>,<span class="st">"wood"</span>,<span class="st">"ca"</span>,<span class="st">"wood"</span>,<span class="st">"wood"</span>,<span class="st">"sumi"</span>,<span class="st">"ca"</span>,<span class="st">"sumi"</span>,
              <span class="st">"wood"</span>,<span class="st">"wood"</span>,<span class="st">"sumi"</span>,<span class="st">"sumi"</span>,<span class="st">"wood"</span>,<span class="st">"ca"</span>,<span class="st">"ca"</span>,<span class="st">"wood"</span>,<span class="st">"ca"</span>,<span class="st">"sumi"</span>,<span class="st">"ca"</span>,<span class="st">"ca"</span>,
              <span class="st">"ca"</span>,<span class="st">"ca"</span>,<span class="st">"hybrid"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="step-2-quality-filtering" class="section level1">
<h1 class="hasAnchor">
<a href="#step-2-quality-filtering" class="anchor"></a>Step 2: quality filtering</h1>
<div id="implement-quality-filters-that-dont-involve-missing-data--this-is-because-removing-low-data-samples-will-alter-percentagequantile-based-missing-data-cutoffs-so-we-wait-to-implement-those-until-after-deciding-on-our-final-set-of-samples-for-downstream-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#implement-quality-filters-that-dont-involve-missing-data--this-is-because-removing-low-data-samples-will-alter-percentagequantile-based-missing-data-cutoffs-so-we-wait-to-implement-those-until-after-deciding-on-our-final-set-of-samples-for-downstream-analysis" class="anchor"></a>Implement quality filters that don’t involve missing data. This is because removing low data samples will alter percentage/quantile based missing data cutoffs, so we wait to implement those until after deciding on our final set of samples for downstream analysis</h3>
</div>
<div id="note" class="section level3">
<h3 class="hasAnchor">
<a href="#note" class="anchor"></a>Note:</h3>
<p>Jon Puritz has an excellent filtering tutorial that is focused specifically on <a href="https://www.ddocent.com/filtering/">filtering RADseq data</a> Multiple functions in SNPfiltR were generated in order to follow the guidelines and suggestions laid out in this tutorial. We can follow these guidelines for hard filtering (he suggests minimum depth=3, gq =30), and can implement suggested filters like allele balance and max depth, here in R using SNPfiltR.</p>
<div id="start-by-visualizing-the-distributions-of-depth-of-sequencing-and-genotype-quality-among-called-genotypes-then-set-appropriate-cutoffs-for-both-values-for-this-dataset-" class="section level4">
<h4 class="hasAnchor">
<a href="#start-by-visualizing-the-distributions-of-depth-of-sequencing-and-genotype-quality-among-called-genotypes-then-set-appropriate-cutoffs-for-both-values-for-this-dataset-" class="anchor"></a>start by visualizing the distributions of depth of sequencing and genotype quality among called genotypes, then set appropriate cutoffs for both values for this dataset.</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#visualize distributions</span>
<span class="fu"><a href="../reference/hard_filter.html">hard_filter</a></span><span class="op">(</span>vcfR<span class="op">=</span><span class="va">vcfR</span><span class="op">)</span>
<span class="co">#&gt; no depth cutoff provided, exploratory visualization will be generated.</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-5-1.png" width="900"></p>
<pre><code>#&gt; no genotype quality cutoff provided, exploratory visualization will be generated.</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-5-2.png" width="900"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-5-3.png" width="900"></p>
<pre><code>#&gt; ***** Object of Class vcfR *****
#&gt; 28 samples
#&gt; 4524 CHROMs
#&gt; 44,490 variants
#&gt; Object size: 40.2 Mb
#&gt; 31.02 percent missing data
#&gt; *****        *****         *****

#hard filter to minimum depth of 5, and minimum genotype quality of 30
vcfR&lt;-hard_filter(vcfR=vcfR, depth = 3, gq = 20)
#&gt; 16.89% of genotypes fall below a read depth of 3 and were converted to NA
#&gt; 31.72% of genotypes fall below a genotype quality of 20 and were converted to NA

#remove loci with &gt; 2 alleles
vcfR&lt;-filter_biallelic(vcfR)
#&gt; 228 SNPs, 0.005% of all input SNPs, contained more than 2 alleles, and were removed from the VCF</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-5-4.png" width="900"></p>
</div>
<div id="then-use-this-function-to-filter-for-allele-balance" class="section level4">
<h4 class="hasAnchor">
<a href="#then-use-this-function-to-filter-for-allele-balance" class="anchor"></a>Then use this function to filter for allele balance</h4>
<p>From the <a href="https://www.ddocent.com/filtering/">Ddocent SNP filtering tutorial</a> “Allele balance: a number between 0 and 1 representing the ratio of reads showing the reference allele to all reads, considering only reads from individuals called as heterozygous, we expect that the allele balance in our data (for real loci) should be close to 0.5”</p>
</div>
<div id="the-snpfiltr-allele-balance-function-will-convert-heterozygous-genotypes-to-missing-if-they-fall-outside-of-the--25--75-range-" class="section level4">
<h4 class="hasAnchor">
<a href="#the-snpfiltr-allele-balance-function-will-convert-heterozygous-genotypes-to-missing-if-they-fall-outside-of-the--25--75-range-" class="anchor"></a>the SNPfiltR allele balance function will convert heterozygous genotypes to missing if they fall outside of the .25-.75 range.</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#execute allele balance filter</span>
<span class="va">vcfR</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/filter_allele_balance.html">filter_allele_balance</a></span><span class="op">(</span><span class="va">vcfR</span><span class="op">)</span>
<span class="co">#&gt; 38.85% of het genotypes (6.12% of all genotypes) fall outside of .25 - .75 allele balance and were converted to NA</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-6-1.png" width="900"></p>
<p>Now we can execute a max depth filter (super high depth loci are likely multiple loci stuck together into a single paralogous locus).</p>
</div>
</div>
<div id="note-1" class="section level3">
<h3 class="hasAnchor">
<a href="#note-1" class="anchor"></a>Note:</h3>
<p>This filter is applied ‘per SNP’ rather than ‘per genotype’ otherwise we would simply be removing most of the genotypes from our deepest sequenced samples (because sequencing depth is so variable between samples). By filtering per SNP, we remove the SNPs with outlier depth values, which are most likely to be spuriously mapped/built paralagous loci.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#visualize and pick appropriate max depth cutoff</span>
<span class="fu"><a href="../reference/max_depth.html">max_depth</a></span><span class="op">(</span><span class="va">vcfR</span><span class="op">)</span>
<span class="co">#&gt; cutoff is not specified, exploratory visualization will be generated.</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-7-1.png" width="900"></p>
<pre><code>#&gt; dashed line indicates a mean depth across all SNPs of 39.7</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-7-2.png" width="900"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#filter vcf by the max depth cutoff you chose</span>
<span class="va">vcfR</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/max_depth.html">max_depth</a></span><span class="op">(</span><span class="va">vcfR</span>, maxdepth <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>
<span class="co">#&gt; maxdepth cutoff is specified, filtered vcfR object will be returned</span>
<span class="co">#&gt; 2.32% of SNPs were above a mean depth of 150 and were removed from the vcf</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-7-3.png" width="900"></p>
</div>
<div id="note-2" class="section level3">
<h3 class="hasAnchor">
<a href="#note-2" class="anchor"></a>Note:</h3>
<p>It may be a good idea to additionally filter out SNPs that are significantly out of HWE if you have a really good idea of what the population structure in your sample looks like and good sample sizes in each pop. For this dataset, which is highly structured (many isolated island pops) with species boundaries that are in flux, I am not going to use a HWE filter, because I don’t feel comfortable confidently identifying populations in which we can expect HWE. Many other programs (such as VCFtools) can filter according to HWE if desired.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#remove invariant SNPs generated during the genotype filtering steps</span>
<span class="va">vcfR</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/min_mac.html">min_mac</a></span><span class="op">(</span><span class="va">vcfR</span>, min.mac <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; 38.88% of SNPs fell below a minor allele count of 1 and were removed from the VCF</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#check vcfR to see how many SNPs we have left</span>
<span class="va">vcfR</span>
<span class="co">#&gt; ***** Object of Class vcfR *****</span>
<span class="co">#&gt; 28 samples</span>
<span class="co">#&gt; 4158 CHROMs</span>
<span class="co">#&gt; 26,425 variants</span>
<span class="co">#&gt; Object size: 24.2 Mb</span>
<span class="co">#&gt; 58.53 percent missing data</span>
<span class="co">#&gt; *****        *****         *****</span></code></pre></div>
</div>
</div>
<div id="step-3-set-missing-data-per-sample-cutoff" class="section level1">
<h1 class="hasAnchor">
<a href="#step-3-set-missing-data-per-sample-cutoff" class="anchor"></a>Step 3: set missing data per sample cutoff</h1>
<div id="set-arbitrary-cutoff-for-missing-data-allowed-per-sample-" class="section level3">
<h3 class="hasAnchor">
<a href="#set-arbitrary-cutoff-for-missing-data-allowed-per-sample-" class="anchor"></a>Set arbitrary cutoff for missing data allowed per sample.</h3>
<p>Determining which samples and SNPs to retain is always project specific, and is contingent on sampling, biology of the focal taxa, sequencing idiosyncrasies, etc. SNPfiltR contains functions designed to simply and easily generate exploratory visualizations that will allow you to make informed decisions about which samples and SNPs are of sufficient quality to retain for downstream analyses, but there is never a single correct option for these cutoffs. In my experience, the best thing to do is to look at your data, look at what effects some reasonable cutoffs would have on your data, and pick one that works for you. Then as you continue to analyze your data, make sure that your arbitrary filtering decisions are not driving the patterns you see, and iteratively update your filtering approach if you are concerned about the effects previous filtering choices are having on downstream results.</p>
</div>
<div id="we-will-start-by-determining-which-samples-contain-too-few-sequences-to-be-used-in-downstream-analyses-by-visualizing-missing-data-per-sample" class="section level3">
<h3 class="hasAnchor">
<a href="#we-will-start-by-determining-which-samples-contain-too-few-sequences-to-be-used-in-downstream-analyses-by-visualizing-missing-data-per-sample" class="anchor"></a>We will start by determining which samples contain too few sequences to be used in downstream analyses, by visualizing missing data per sample</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#run function to visualize samples</span>
<span class="va">miss</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/missing_by_sample.html">missing_by_sample</a></span><span class="op">(</span>vcfR<span class="op">=</span><span class="va">vcfR</span>, popmap <span class="op">=</span> <span class="va">popmap</span><span class="op">)</span>
<span class="co">#&gt; Warning: Groups with fewer than two data points have been dropped.</span>
<span class="co">#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`.</span>
<span class="co">#&gt; Warning: Groups with fewer than two data points have been dropped.</span>
<span class="co">#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-9-1.png" width="900"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-9-2.png" width="900"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-9-3.png" width="900"></p>
<div id="we-can-see-that-there-are-about-7-samples-with-really-high-levels-of-missing-data--one-approach-would-be-to-simply-drop-these-samples-and-continue-on-with-only-the-high-quality-samples--because-they-retained-all-samples-except-one-in-the-paper-we-will-continue-on-and-see-if-we-can-salvage-all-samples-via-stringent-filtering-" class="section level4">
<h4 class="hasAnchor">
<a href="#we-can-see-that-there-are-about-7-samples-with-really-high-levels-of-missing-data--one-approach-would-be-to-simply-drop-these-samples-and-continue-on-with-only-the-high-quality-samples--because-they-retained-all-samples-except-one-in-the-paper-we-will-continue-on-and-see-if-we-can-salvage-all-samples-via-stringent-filtering-" class="anchor"></a>we can see that there are about 7 samples with really high levels of missing data. One approach would be to simply drop these samples, and continue on with only the high quality samples. Because they retained all samples (except one) in the paper, we will continue on and see if we can salvage all samples via stringent filtering.</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#assess whether missing data is driving clustering patterns among the retained samples</span>
<span class="va">clust</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/assess_missing_data_pca.html">assess_missing_data_pca</a></span><span class="op">(</span>vcfR<span class="op">=</span><span class="va">vcfR</span>, popmap <span class="op">=</span> <span class="va">popmap</span>, thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.75</span>,<span class="fl">.8</span>,<span class="fl">.85</span><span class="op">)</span>, clustering <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; cutoff is specified, filtered vcfR object will be returned</span>
<span class="co">#&gt; 83.72% of SNPs fell below a completeness cutoff of 0.75 and were removed from the VCF</span>
<span class="co">#&gt; Loading required namespace: adegenet</span>
<span class="co">#&gt; Registered S3 method overwritten by 'spdep':</span>
<span class="co">#&gt;   method   from</span>
<span class="co">#&gt;   plot.mst ape</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-1.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<pre><code>#&gt; cutoff is specified, filtered vcfR object will be returned</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-3.png" width="700"></p>
<pre><code>#&gt; 91.09% of SNPs fell below a completeness cutoff of 0.8 and were removed from the VCF</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-4.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-5.png" width="700"></p>
<pre><code>#&gt; cutoff is specified, filtered vcfR object will be returned</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-6.png" width="700"></p>
<pre><code>#&gt; 93.79% of SNPs fell below a completeness cutoff of 0.85 and were removed from the VCF</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-7.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-8.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-9.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#proportion missing data seems to be driving PC2</span>
<span class="co">#but the effect seems to be somewhat mitigated above 80% completeness threshold per SNP</span>
<span class="co">#except for that single terrible sample (144749) which was actually dropped in the paper due to contamination concerns. We will drop it and see if that makes the situation better</span>

<span class="co">#drop potentially contaminated sample with low data</span>
<span class="va">vcfR</span> <span class="op">&lt;-</span> <span class="va">vcfR</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">vcfR</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"wesj-144749"</span><span class="op">]</span>
<span class="co">#subset popmap to only include retained individuals</span>
<span class="va">popmap</span><span class="op">&lt;-</span><span class="va">popmap</span><span class="op">[</span><span class="va">popmap</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">vcfR</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span>,<span class="op">]</span>

<span class="co">#remove invariant sites, which arise from dropping samples</span>
<span class="va">vcfR</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/min_mac.html">min_mac</a></span><span class="op">(</span><span class="va">vcfR</span>, min.mac <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; 2.13% of SNPs fell below a minor allele count of 1 and were removed from the VCF</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-10.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#re-assess whether missing data is driving clustering patterns after dropping terrible sample</span>
<span class="va">clust</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/assess_missing_data_pca.html">assess_missing_data_pca</a></span><span class="op">(</span>vcfR<span class="op">=</span><span class="va">vcfR</span>, popmap <span class="op">=</span> <span class="va">popmap</span>, thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.75</span>,<span class="fl">.8</span>,<span class="fl">.85</span><span class="op">)</span>, clustering <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; cutoff is specified, filtered vcfR object will be returned</span>
<span class="co">#&gt; 85.21% of SNPs fell below a completeness cutoff of 0.75 and were removed from the VCF</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-11.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-12.png" width="700"></p>
<pre><code>#&gt; cutoff is specified, filtered vcfR object will be returned</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-13.png" width="700"></p>
<pre><code>#&gt; 89.11% of SNPs fell below a completeness cutoff of 0.8 and were removed from the VCF</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-14.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-15.png" width="700"></p>
<pre><code>#&gt; cutoff is specified, filtered vcfR object will be returned</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-16.png" width="700"></p>
<pre><code>#&gt; 92.41% of SNPs fell below a completeness cutoff of 0.85 and were removed from the VCF</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-17.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-18.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-10-19.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#clustering still not great, but at least doesn't seem to be as driven by missing data patterns now</span></code></pre></div>
</div>
</div>
</div>
<div id="step-4-set-missing-data-per-snp-cutoff" class="section level1">
<h1 class="hasAnchor">
<a href="#step-4-set-missing-data-per-snp-cutoff" class="anchor"></a>Step 4: set missing data per SNP cutoff</h1>
<div id="set-arbitrary-cutoff-for-missing-data-allowed-per-snp-" class="section level3">
<h3 class="hasAnchor">
<a href="#set-arbitrary-cutoff-for-missing-data-allowed-per-snp-" class="anchor"></a>Set arbitrary cutoff for missing data allowed per SNP.</h3>
<div id="we-can-visualize-the-effect-that-typical-missing-data-cutoffs-will-have-on-both-the-number-of-snps-retained-and-the-total-missing-data-in-our-entire-dataset-we-want-to-choose-a-cutoff-that-minimizes-the-overall-missing-data-in-the-dataset-while-maximizing-the-total-number-of-loci-retained-" class="section level4">
<h4 class="hasAnchor">
<a href="#we-can-visualize-the-effect-that-typical-missing-data-cutoffs-will-have-on-both-the-number-of-snps-retained-and-the-total-missing-data-in-our-entire-dataset-we-want-to-choose-a-cutoff-that-minimizes-the-overall-missing-data-in-the-dataset-while-maximizing-the-total-number-of-loci-retained-" class="anchor"></a>We can visualize the effect that typical missing data cutoffs will have on both the number of SNPs retained and the total missing data in our entire dataset.We want to choose a cutoff that minimizes the overall missing data in the dataset, while maximizing the total number of loci retained.</h4>
</div>
</div>
<div id="note-3" class="section level3">
<h3 class="hasAnchor">
<a href="#note-3" class="anchor"></a>Note:</h3>
<p>This filter interacts with the above filter, where we dropped low data samples. A good rule of thumb is that individual samples shouldn’t be above 50% missing data after applying a per-SNP missing data cutoff. So if we are retaining specific low data samples out of necessity or project design, we may have to set a more stringent per-SNP missing data cutoff, at the expense of the total number of SNPs retained for downstream analyses. We can again use the assess_missing_data_pca() function to determine whether all retained samples contain enough data at our chosen cutoff in order to be assigned accurately to their species group.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#visualize missing data by SNP and the effect of various cutoffs on the missingness of each sample</span>
<span class="fu"><a href="../reference/missing_by_snp.html">missing_by_snp</a></span><span class="op">(</span><span class="va">vcfR</span><span class="op">)</span>
<span class="co">#&gt; cutoff is not specified, exploratory visualizations will be generated</span>
<span class="co">#&gt; Picking joint bandwidth of 0.112</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-11-1.png" width="900"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-11-2.png" width="900"></p>
<pre><code>#&gt;    filt missingness snps.retained
#&gt; 1  0.30  0.37746555         14543
#&gt; 2  0.50  0.27894654         10093
#&gt; 3  0.60  0.23272021          7871
#&gt; 4  0.65  0.21548196          6995
#&gt; 5  0.70  0.19623532          6013
#&gt; 6  0.75  0.14944532          3826
#&gt; 7  0.80  0.12334280          2816
#&gt; 8  0.85  0.09651505          1964
#&gt; 9  0.90  0.04844337           828
#&gt; 10 0.95  0.02528736           435
#&gt; 11 1.00  0.00000000           138

#try using t-SNE, a machine learning algorithm, for dimensionality reduction and visualization of sample clustering in two-dimensional space
#verify that missing data is not driving clustering patterns among the retained samples at some reasonable thresholds
miss&lt;-assess_missing_data_tsne(vcfR=vcfR, popmap = popmap, thresholds = c(.75,.85), clustering = FALSE, iterations = 5000, perplexity = 3)
#&gt; cutoff is specified, filtered vcfR object will be returned
#&gt; 85.21% of SNPs fell below a completeness cutoff of 0.75 and were removed from the VCF</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-11-3.png" width="900"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-11-4.png" width="900"></p>
<pre><code>#&gt; cutoff is specified, filtered vcfR object will be returned</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-11-5.png" width="900"></p>
<pre><code>#&gt; 92.41% of SNPs fell below a completeness cutoff of 0.85 and were removed from the VCF</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-11-6.png" width="900"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-11-7.png" width="900"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-11-8.png" width="900"></p>
<div id="missing-data-is-not-driving-the-patterns-of-clustering-here-but-there-are-really-strange-and-messy-patterns" class="section level4">
<h4 class="hasAnchor">
<a href="#missing-data-is-not-driving-the-patterns-of-clustering-here-but-there-are-really-strange-and-messy-patterns" class="anchor"></a>missing data is not driving the patterns of clustering here, but there are really strange and messy patterns</h4>
<p>#the paper talks about contamination between samples on the sequencing lane, and it seems that although the species generally cluster, there are contamination issues preventing clean inference</p>
</div>
<div id="according-to-the-paper-there-are-legitimately-two-groups-in-woodhouseii-interior-us-and-northern-mexico-but-californica-should-all-cluster-together-" class="section level4">
<h4 class="hasAnchor">
<a href="#according-to-the-paper-there-are-legitimately-two-groups-in-woodhouseii-interior-us-and-northern-mexico-but-californica-should-all-cluster-together-" class="anchor"></a>according to the paper, there are legitimately two groups in woodhouseii (interior US and northern Mexico), but californica should all cluster together.</h4>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#choose a value that retains an acceptable amount of missing data in each sample, and maximizes SNPs retained while minimizing overall missing data, and filter vcf</span>
<span class="va">vcfR</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/missing_by_snp.html">missing_by_snp</a></span><span class="op">(</span><span class="va">vcfR</span>, cutoff <span class="op">=</span> <span class="fl">.85</span><span class="op">)</span>
<span class="co">#&gt; cutoff is specified, filtered vcfR object will be returned</span>
<span class="co">#&gt; 92.41% of SNPs fell below a completeness cutoff of 0.85 and were removed from the VCF</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#check how many SNPs and samples are left</span>
<span class="va">vcfR</span>
<span class="co">#&gt; ***** Object of Class vcfR *****</span>
<span class="co">#&gt; 27 samples</span>
<span class="co">#&gt; 1153 CHROMs</span>
<span class="co">#&gt; 1,964 variants</span>
<span class="co">#&gt; Object size: 4 Mb</span>
<span class="co">#&gt; 9.652 percent missing data</span>
<span class="co">#&gt; *****        *****         *****</span></code></pre></div>
</div>
</div>
</div>
<div id="step-5-minor-allele-and-linkage-filtering" class="section level1">
<h1 class="hasAnchor">
<a href="#step-5-minor-allele-and-linkage-filtering" class="anchor"></a>Step 5: minor allele and linkage filtering</h1>
<div id="investigate-the-effect-of-a-minor-allele-count-mac-cutoff-on-downstream-inferences--we-always-want-to-do-this-last-because-these-filters-are-not-quality-aware-and-using-them-early-in-the-pipeline-will-result-in-dumping-good-snps-" class="section level3">
<h3 class="hasAnchor">
<a href="#investigate-the-effect-of-a-minor-allele-count-mac-cutoff-on-downstream-inferences--we-always-want-to-do-this-last-because-these-filters-are-not-quality-aware-and-using-them-early-in-the-pipeline-will-result-in-dumping-good-snps-" class="anchor"></a>investigate the effect of a minor allele count (MAC) cutoff on downstream inferences. We always want to do this last, because these filters are not quality aware, and using them early in the pipeline will result in dumping good SNPs.</h3>
<div id="macmaf-cutoffs-can-be-helpful-in-removing-spurious-and-uninformative-loci-from-the-dataset-but-also-have-the-potential-to-bias-downstream-inferences--linck-and-battey-2019-have-an-excellent-paper-on-just-this-topic--from-the-paper-" class="section level4">
<h4 class="hasAnchor">
<a href="#macmaf-cutoffs-can-be-helpful-in-removing-spurious-and-uninformative-loci-from-the-dataset-but-also-have-the-potential-to-bias-downstream-inferences--linck-and-battey-2019-have-an-excellent-paper-on-just-this-topic--from-the-paper-" class="anchor"></a>MAC/MAF cutoffs can be helpful in removing spurious and uninformative loci from the dataset, but also have the potential to bias downstream inferences. Linck and Battey (2019) have an excellent paper on just this topic. From the paper-</h4>
<p>“We recommend researchers using model‐based programs to describe population structure observe the following best practices: (a) duplicate analyses with nonparametric methods suchas PCA and DAPC with cross validation (b) exclude singletons (c) compare alignments with multiple assembly parameters When seeking to exclude only singletons in alignments with missing data (a ubiquitous problem for reduced‐representation library preparation methods), it is preferable to filter by the count (rather than frequency) of the minor allele, because variation in the amount of missing data across an alignment will cause a static frequency cutoff to remove different SFS classes at different sites”"</p>
</div>
<div id="our-package-contains-a-convenient-wrapper-functions-that-can-filter-based-on-minor-allele-count-mac-and-streamline-investigation-of-the-effects-of-various-filtering-parameters-on-sample-clustering-patterns-" class="section level4">
<h4 class="hasAnchor">
<a href="#our-package-contains-a-convenient-wrapper-functions-that-can-filter-based-on-minor-allele-count-mac-and-streamline-investigation-of-the-effects-of-various-filtering-parameters-on-sample-clustering-patterns-" class="anchor"></a>Our package contains a convenient wrapper functions that can filter based on minor allele count (MAC) and streamline investigation of the effects of various filtering parameters on sample clustering patterns.</h4>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#investigate clustering patterns with and without a minor allele cutoff</span>
<span class="co">#use min.mac() to investigate the effect of multiple cutoffs</span>
<span class="va">vcfR.mac</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/min_mac.html">min_mac</a></span><span class="op">(</span>vcfR <span class="op">=</span> <span class="va">vcfR</span>, min.mac <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; 65.43% of SNPs fell below a minor allele count of 2 and were removed from the VCF</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-13-1.png" width="900"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#assess clustering without MAC cutoff</span>
<span class="va">miss</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/assess_missing_data_tsne.html">assess_missing_data_tsne</a></span><span class="op">(</span><span class="va">vcfR</span>, <span class="va">popmap</span>, clustering <span class="op">=</span> <span class="cn">FALSE</span>, iterations <span class="op">=</span> <span class="fl">5000</span>, perplexity <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-13-2.png" width="900"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-13-3.png" width="900"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#assess clustering with MAC cutoff</span>
<span class="va">miss</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/assess_missing_data_tsne.html">assess_missing_data_tsne</a></span><span class="op">(</span><span class="va">vcfR.mac</span>, <span class="va">popmap</span>, clustering <span class="op">=</span> <span class="cn">FALSE</span>, iterations <span class="op">=</span> <span class="fl">5000</span>, perplexity <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-13-4.png" width="900"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-13-5.png" width="900"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#singletons don't seem to be biasing the datset, so I will keep them in for now</span></code></pre></div>
</div>
<div id="try-thinning-the-dataset-to-one-snp-per-locus-a-common-approach-for-uces" class="section level4">
<h4 class="hasAnchor">
<a href="#try-thinning-the-dataset-to-one-snp-per-locus-a-common-approach-for-uces" class="anchor"></a>try thinning the dataset to one SNP per locus, a common approach for UCE’s</h4>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#linkage filter vcf to thin SNPs to one per 10kb</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>vcfR.thin<span class="ot">&lt;-</span><span class="fu">distance_thin</span>(vcfR, <span class="at">min.distance =</span> <span class="dv">10000</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                                      <span class="er">|</span>   <span class="dv">0</span>%</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                                      <span class="er">|</span>   <span class="dv">1</span>%</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=</span>                                                                     <span class="er">|</span>   <span class="dv">1</span>%</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=</span>                                                                     <span class="er">|</span>   <span class="dv">2</span>%</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==</span>                                                                    <span class="er">|</span>   <span class="dv">2</span>%</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==</span>                                                                    <span class="er">|</span>   <span class="dv">3</span>%</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==</span>                                                                    <span class="er">|</span>   <span class="dv">4</span>%</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===</span>                                                                   <span class="er">|</span>   <span class="dv">4</span>%</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===</span>                                                                   <span class="er">|</span>   <span class="dv">5</span>%</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====</span>                                                                  <span class="er">|</span>   <span class="dv">5</span>%</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====</span>                                                                  <span class="er">|</span>   <span class="dv">6</span>%</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====</span>                                                                 <span class="er">|</span>   <span class="dv">7</span>%</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====</span>                                                                 <span class="er">|</span>   <span class="dv">8</span>%</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======</span>                                                                <span class="er">|</span>   <span class="dv">8</span>%</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======</span>                                                                <span class="er">|</span>   <span class="dv">9</span>%</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=======</span>                                                               <span class="er">|</span>   <span class="dv">9</span>%</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=======</span>                                                               <span class="er">|</span>  <span class="dv">10</span>%</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=======</span>                                                               <span class="er">|</span>  <span class="dv">11</span>%</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>  <span class="er">|========</span>                                                              <span class="er">|</span>  <span class="dv">11</span>%</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  <span class="er">|========</span>                                                              <span class="er">|</span>  <span class="dv">12</span>%</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========</span>                                                             <span class="er">|</span>  <span class="dv">12</span>%</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========</span>                                                             <span class="er">|</span>  <span class="dv">13</span>%</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========</span>                                                             <span class="er">|</span>  <span class="dv">14</span>%</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========</span>                                                            <span class="er">|</span>  <span class="dv">14</span>%</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========</span>                                                            <span class="er">|</span>  <span class="dv">15</span>%</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===========</span>                                                           <span class="er">|</span>  <span class="dv">15</span>%</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===========</span>                                                           <span class="er">|</span>  <span class="dv">16</span>%</span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============</span>                                                          <span class="er">|</span>  <span class="dv">16</span>%</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============</span>                                                          <span class="er">|</span>  <span class="dv">17</span>%</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============</span>                                                          <span class="er">|</span>  <span class="dv">18</span>%</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=============</span>                                                         <span class="er">|</span>  <span class="dv">18</span>%</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=============</span>                                                         <span class="er">|</span>  <span class="dv">19</span>%</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==============</span>                                                        <span class="er">|</span>  <span class="dv">19</span>%</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==============</span>                                                        <span class="er">|</span>  <span class="dv">20</span>%</span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==============</span>                                                        <span class="er">|</span>  <span class="dv">21</span>%</span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============</span>                                                       <span class="er">|</span>  <span class="dv">21</span>%</span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============</span>                                                       <span class="er">|</span>  <span class="dv">22</span>%</span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>  <span class="er">|================</span>                                                      <span class="er">|</span>  <span class="dv">22</span>%</span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a>  <span class="er">|================</span>                                                      <span class="er">|</span>  <span class="dv">23</span>%</span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a>  <span class="er">|================</span>                                                      <span class="er">|</span>  <span class="dv">24</span>%</span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=================</span>                                                     <span class="er">|</span>  <span class="dv">24</span>%</span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=================</span>                                                     <span class="er">|</span>  <span class="dv">25</span>%</span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================</span>                                                    <span class="er">|</span>  <span class="dv">25</span>%</span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================</span>                                                    <span class="er">|</span>  <span class="dv">26</span>%</span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================</span>                                                   <span class="er">|</span>  <span class="dv">26</span>%</span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================</span>                                                   <span class="er">|</span>  <span class="dv">27</span>%</span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================</span>                                                   <span class="er">|</span>  <span class="dv">28</span>%</span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====================</span>                                                  <span class="er">|</span>  <span class="dv">28</span>%</span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====================</span>                                                  <span class="er">|</span>  <span class="dv">29</span>%</span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================</span>                                                 <span class="er">|</span>  <span class="dv">29</span>%</span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================</span>                                                 <span class="er">|</span>  <span class="dv">30</span>%</span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================</span>                                                 <span class="er">|</span>  <span class="dv">31</span>%</span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================</span>                                                <span class="er">|</span>  <span class="dv">31</span>%</span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================</span>                                                <span class="er">|</span>  <span class="dv">32</span>%</span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=======================</span>                                               <span class="er">|</span>  <span class="dv">32</span>%</span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=======================</span>                                               <span class="er">|</span>  <span class="dv">33</span>%</span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=======================</span>                                               <span class="er">|</span>  <span class="dv">34</span>%</span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a>  <span class="er">|========================</span>                                              <span class="er">|</span>  <span class="dv">34</span>%</span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true" tabindex="-1"></a>  <span class="er">|========================</span>                                              <span class="er">|</span>  <span class="dv">35</span>%</span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================</span>                                             <span class="er">|</span>  <span class="dv">35</span>%</span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================</span>                                             <span class="er">|</span>  <span class="dv">36</span>%</span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================</span>                                            <span class="er">|</span>  <span class="dv">37</span>%</span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================</span>                                            <span class="er">|</span>  <span class="dv">38</span>%</span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===========================</span>                                           <span class="er">|</span>  <span class="dv">38</span>%</span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===========================</span>                                           <span class="er">|</span>  <span class="dv">39</span>%</span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================</span>                                          <span class="er">|</span>  <span class="dv">39</span>%</span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================</span>                                          <span class="er">|</span>  <span class="dv">40</span>%</span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================</span>                                          <span class="er">|</span>  <span class="dv">41</span>%</span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=============================</span>                                         <span class="er">|</span>  <span class="dv">41</span>%</span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=============================</span>                                         <span class="er">|</span>  <span class="dv">42</span>%</span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==============================</span>                                        <span class="er">|</span>  <span class="dv">42</span>%</span>
<span id="cb36-146"><a href="#cb36-146" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-147"><a href="#cb36-147" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==============================</span>                                        <span class="er">|</span>  <span class="dv">43</span>%</span>
<span id="cb36-148"><a href="#cb36-148" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-149"><a href="#cb36-149" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==============================</span>                                        <span class="er">|</span>  <span class="dv">44</span>%</span>
<span id="cb36-150"><a href="#cb36-150" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-151"><a href="#cb36-151" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================</span>                                       <span class="er">|</span>  <span class="dv">44</span>%</span>
<span id="cb36-152"><a href="#cb36-152" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-153"><a href="#cb36-153" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================</span>                                       <span class="er">|</span>  <span class="dv">45</span>%</span>
<span id="cb36-154"><a href="#cb36-154" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-155"><a href="#cb36-155" aria-hidden="true" tabindex="-1"></a>  <span class="er">|================================</span>                                      <span class="er">|</span>  <span class="dv">45</span>%</span>
<span id="cb36-156"><a href="#cb36-156" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-157"><a href="#cb36-157" aria-hidden="true" tabindex="-1"></a>  <span class="er">|================================</span>                                      <span class="er">|</span>  <span class="dv">46</span>%</span>
<span id="cb36-158"><a href="#cb36-158" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-159"><a href="#cb36-159" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=================================</span>                                     <span class="er">|</span>  <span class="dv">46</span>%</span>
<span id="cb36-160"><a href="#cb36-160" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-161"><a href="#cb36-161" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=================================</span>                                     <span class="er">|</span>  <span class="dv">47</span>%</span>
<span id="cb36-162"><a href="#cb36-162" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-163"><a href="#cb36-163" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=================================</span>                                     <span class="er">|</span>  <span class="dv">48</span>%</span>
<span id="cb36-164"><a href="#cb36-164" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-165"><a href="#cb36-165" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================</span>                                    <span class="er">|</span>  <span class="dv">48</span>%</span>
<span id="cb36-166"><a href="#cb36-166" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-167"><a href="#cb36-167" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================</span>                                    <span class="er">|</span>  <span class="dv">49</span>%</span>
<span id="cb36-168"><a href="#cb36-168" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-169"><a href="#cb36-169" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================================</span>                                   <span class="er">|</span>  <span class="dv">49</span>%</span>
<span id="cb36-170"><a href="#cb36-170" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-171"><a href="#cb36-171" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================================</span>                                   <span class="er">|</span>  <span class="dv">50</span>%</span>
<span id="cb36-172"><a href="#cb36-172" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-173"><a href="#cb36-173" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================================</span>                                   <span class="er">|</span>  <span class="dv">51</span>%</span>
<span id="cb36-174"><a href="#cb36-174" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-175"><a href="#cb36-175" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====================================</span>                                  <span class="er">|</span>  <span class="dv">51</span>%</span>
<span id="cb36-176"><a href="#cb36-176" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-177"><a href="#cb36-177" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====================================</span>                                  <span class="er">|</span>  <span class="dv">52</span>%</span>
<span id="cb36-178"><a href="#cb36-178" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-179"><a href="#cb36-179" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================================</span>                                 <span class="er">|</span>  <span class="dv">52</span>%</span>
<span id="cb36-180"><a href="#cb36-180" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-181"><a href="#cb36-181" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================================</span>                                 <span class="er">|</span>  <span class="dv">53</span>%</span>
<span id="cb36-182"><a href="#cb36-182" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-183"><a href="#cb36-183" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================================</span>                                 <span class="er">|</span>  <span class="dv">54</span>%</span>
<span id="cb36-184"><a href="#cb36-184" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-185"><a href="#cb36-185" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================</span>                                <span class="er">|</span>  <span class="dv">54</span>%</span>
<span id="cb36-186"><a href="#cb36-186" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-187"><a href="#cb36-187" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================</span>                                <span class="er">|</span>  <span class="dv">55</span>%</span>
<span id="cb36-188"><a href="#cb36-188" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-189"><a href="#cb36-189" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=======================================</span>                               <span class="er">|</span>  <span class="dv">55</span>%</span>
<span id="cb36-190"><a href="#cb36-190" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-191"><a href="#cb36-191" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=======================================</span>                               <span class="er">|</span>  <span class="dv">56</span>%</span>
<span id="cb36-192"><a href="#cb36-192" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-193"><a href="#cb36-193" aria-hidden="true" tabindex="-1"></a>  <span class="er">|========================================</span>                              <span class="er">|</span>  <span class="dv">56</span>%</span>
<span id="cb36-194"><a href="#cb36-194" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-195"><a href="#cb36-195" aria-hidden="true" tabindex="-1"></a>  <span class="er">|========================================</span>                              <span class="er">|</span>  <span class="dv">57</span>%</span>
<span id="cb36-196"><a href="#cb36-196" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-197"><a href="#cb36-197" aria-hidden="true" tabindex="-1"></a>  <span class="er">|========================================</span>                              <span class="er">|</span>  <span class="dv">58</span>%</span>
<span id="cb36-198"><a href="#cb36-198" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-199"><a href="#cb36-199" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================================</span>                             <span class="er">|</span>  <span class="dv">58</span>%</span>
<span id="cb36-200"><a href="#cb36-200" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-201"><a href="#cb36-201" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================================</span>                             <span class="er">|</span>  <span class="dv">59</span>%</span>
<span id="cb36-202"><a href="#cb36-202" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-203"><a href="#cb36-203" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================================</span>                            <span class="er">|</span>  <span class="dv">59</span>%</span>
<span id="cb36-204"><a href="#cb36-204" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-205"><a href="#cb36-205" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================================</span>                            <span class="er">|</span>  <span class="dv">60</span>%</span>
<span id="cb36-206"><a href="#cb36-206" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-207"><a href="#cb36-207" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================================</span>                            <span class="er">|</span>  <span class="dv">61</span>%</span>
<span id="cb36-208"><a href="#cb36-208" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-209"><a href="#cb36-209" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===========================================</span>                           <span class="er">|</span>  <span class="dv">61</span>%</span>
<span id="cb36-210"><a href="#cb36-210" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-211"><a href="#cb36-211" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===========================================</span>                           <span class="er">|</span>  <span class="dv">62</span>%</span>
<span id="cb36-212"><a href="#cb36-212" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-213"><a href="#cb36-213" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================================</span>                          <span class="er">|</span>  <span class="dv">62</span>%</span>
<span id="cb36-214"><a href="#cb36-214" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-215"><a href="#cb36-215" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================================</span>                          <span class="er">|</span>  <span class="dv">63</span>%</span>
<span id="cb36-216"><a href="#cb36-216" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-217"><a href="#cb36-217" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=============================================</span>                         <span class="er">|</span>  <span class="dv">64</span>%</span>
<span id="cb36-218"><a href="#cb36-218" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-219"><a href="#cb36-219" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=============================================</span>                         <span class="er">|</span>  <span class="dv">65</span>%</span>
<span id="cb36-220"><a href="#cb36-220" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-221"><a href="#cb36-221" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==============================================</span>                        <span class="er">|</span>  <span class="dv">65</span>%</span>
<span id="cb36-222"><a href="#cb36-222" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-223"><a href="#cb36-223" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==============================================</span>                        <span class="er">|</span>  <span class="dv">66</span>%</span>
<span id="cb36-224"><a href="#cb36-224" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-225"><a href="#cb36-225" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================================</span>                       <span class="er">|</span>  <span class="dv">66</span>%</span>
<span id="cb36-226"><a href="#cb36-226" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-227"><a href="#cb36-227" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================================</span>                       <span class="er">|</span>  <span class="dv">67</span>%</span>
<span id="cb36-228"><a href="#cb36-228" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-229"><a href="#cb36-229" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================================</span>                       <span class="er">|</span>  <span class="dv">68</span>%</span>
<span id="cb36-230"><a href="#cb36-230" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-231"><a href="#cb36-231" aria-hidden="true" tabindex="-1"></a>  <span class="er">|================================================</span>                      <span class="er">|</span>  <span class="dv">68</span>%</span>
<span id="cb36-232"><a href="#cb36-232" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-233"><a href="#cb36-233" aria-hidden="true" tabindex="-1"></a>  <span class="er">|================================================</span>                      <span class="er">|</span>  <span class="dv">69</span>%</span>
<span id="cb36-234"><a href="#cb36-234" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-235"><a href="#cb36-235" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=================================================</span>                     <span class="er">|</span>  <span class="dv">69</span>%</span>
<span id="cb36-236"><a href="#cb36-236" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-237"><a href="#cb36-237" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=================================================</span>                     <span class="er">|</span>  <span class="dv">70</span>%</span>
<span id="cb36-238"><a href="#cb36-238" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-239"><a href="#cb36-239" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=================================================</span>                     <span class="er">|</span>  <span class="dv">71</span>%</span>
<span id="cb36-240"><a href="#cb36-240" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-241"><a href="#cb36-241" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================================</span>                    <span class="er">|</span>  <span class="dv">71</span>%</span>
<span id="cb36-242"><a href="#cb36-242" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-243"><a href="#cb36-243" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================================</span>                    <span class="er">|</span>  <span class="dv">72</span>%</span>
<span id="cb36-244"><a href="#cb36-244" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-245"><a href="#cb36-245" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================================================</span>                   <span class="er">|</span>  <span class="dv">72</span>%</span>
<span id="cb36-246"><a href="#cb36-246" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-247"><a href="#cb36-247" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================================================</span>                   <span class="er">|</span>  <span class="dv">73</span>%</span>
<span id="cb36-248"><a href="#cb36-248" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-249"><a href="#cb36-249" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================================================</span>                   <span class="er">|</span>  <span class="dv">74</span>%</span>
<span id="cb36-250"><a href="#cb36-250" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-251"><a href="#cb36-251" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====================================================</span>                  <span class="er">|</span>  <span class="dv">74</span>%</span>
<span id="cb36-252"><a href="#cb36-252" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-253"><a href="#cb36-253" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====================================================</span>                  <span class="er">|</span>  <span class="dv">75</span>%</span>
<span id="cb36-254"><a href="#cb36-254" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-255"><a href="#cb36-255" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================================================</span>                 <span class="er">|</span>  <span class="dv">75</span>%</span>
<span id="cb36-256"><a href="#cb36-256" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-257"><a href="#cb36-257" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================================================</span>                 <span class="er">|</span>  <span class="dv">76</span>%</span>
<span id="cb36-258"><a href="#cb36-258" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-259"><a href="#cb36-259" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================================</span>                <span class="er">|</span>  <span class="dv">76</span>%</span>
<span id="cb36-260"><a href="#cb36-260" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-261"><a href="#cb36-261" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================================</span>                <span class="er">|</span>  <span class="dv">77</span>%</span>
<span id="cb36-262"><a href="#cb36-262" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-263"><a href="#cb36-263" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================================</span>                <span class="er">|</span>  <span class="dv">78</span>%</span>
<span id="cb36-264"><a href="#cb36-264" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-265"><a href="#cb36-265" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=======================================================</span>               <span class="er">|</span>  <span class="dv">78</span>%</span>
<span id="cb36-266"><a href="#cb36-266" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-267"><a href="#cb36-267" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=======================================================</span>               <span class="er">|</span>  <span class="dv">79</span>%</span>
<span id="cb36-268"><a href="#cb36-268" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-269"><a href="#cb36-269" aria-hidden="true" tabindex="-1"></a>  <span class="er">|========================================================</span>              <span class="er">|</span>  <span class="dv">79</span>%</span>
<span id="cb36-270"><a href="#cb36-270" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-271"><a href="#cb36-271" aria-hidden="true" tabindex="-1"></a>  <span class="er">|========================================================</span>              <span class="er">|</span>  <span class="dv">80</span>%</span>
<span id="cb36-272"><a href="#cb36-272" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-273"><a href="#cb36-273" aria-hidden="true" tabindex="-1"></a>  <span class="er">|========================================================</span>              <span class="er">|</span>  <span class="dv">81</span>%</span>
<span id="cb36-274"><a href="#cb36-274" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-275"><a href="#cb36-275" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================================================</span>             <span class="er">|</span>  <span class="dv">81</span>%</span>
<span id="cb36-276"><a href="#cb36-276" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-277"><a href="#cb36-277" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=========================================================</span>             <span class="er">|</span>  <span class="dv">82</span>%</span>
<span id="cb36-278"><a href="#cb36-278" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-279"><a href="#cb36-279" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================================================</span>            <span class="er">|</span>  <span class="dv">82</span>%</span>
<span id="cb36-280"><a href="#cb36-280" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-281"><a href="#cb36-281" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================================================</span>            <span class="er">|</span>  <span class="dv">83</span>%</span>
<span id="cb36-282"><a href="#cb36-282" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-283"><a href="#cb36-283" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================================================</span>            <span class="er">|</span>  <span class="dv">84</span>%</span>
<span id="cb36-284"><a href="#cb36-284" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-285"><a href="#cb36-285" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===========================================================</span>           <span class="er">|</span>  <span class="dv">84</span>%</span>
<span id="cb36-286"><a href="#cb36-286" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-287"><a href="#cb36-287" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===========================================================</span>           <span class="er">|</span>  <span class="dv">85</span>%</span>
<span id="cb36-288"><a href="#cb36-288" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-289"><a href="#cb36-289" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================================================</span>          <span class="er">|</span>  <span class="dv">85</span>%</span>
<span id="cb36-290"><a href="#cb36-290" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-291"><a href="#cb36-291" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============================================================</span>          <span class="er">|</span>  <span class="dv">86</span>%</span>
<span id="cb36-292"><a href="#cb36-292" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-293"><a href="#cb36-293" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=============================================================</span>         <span class="er">|</span>  <span class="dv">86</span>%</span>
<span id="cb36-294"><a href="#cb36-294" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-295"><a href="#cb36-295" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=============================================================</span>         <span class="er">|</span>  <span class="dv">87</span>%</span>
<span id="cb36-296"><a href="#cb36-296" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-297"><a href="#cb36-297" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=============================================================</span>         <span class="er">|</span>  <span class="dv">88</span>%</span>
<span id="cb36-298"><a href="#cb36-298" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-299"><a href="#cb36-299" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==============================================================</span>        <span class="er">|</span>  <span class="dv">88</span>%</span>
<span id="cb36-300"><a href="#cb36-300" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-301"><a href="#cb36-301" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==============================================================</span>        <span class="er">|</span>  <span class="dv">89</span>%</span>
<span id="cb36-302"><a href="#cb36-302" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-303"><a href="#cb36-303" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================================================</span>       <span class="er">|</span>  <span class="dv">89</span>%</span>
<span id="cb36-304"><a href="#cb36-304" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-305"><a href="#cb36-305" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================================================</span>       <span class="er">|</span>  <span class="dv">90</span>%</span>
<span id="cb36-306"><a href="#cb36-306" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-307"><a href="#cb36-307" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================================================</span>       <span class="er">|</span>  <span class="dv">91</span>%</span>
<span id="cb36-308"><a href="#cb36-308" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-309"><a href="#cb36-309" aria-hidden="true" tabindex="-1"></a>  <span class="er">|================================================================</span>      <span class="er">|</span>  <span class="dv">91</span>%</span>
<span id="cb36-310"><a href="#cb36-310" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-311"><a href="#cb36-311" aria-hidden="true" tabindex="-1"></a>  <span class="er">|================================================================</span>      <span class="er">|</span>  <span class="dv">92</span>%</span>
<span id="cb36-312"><a href="#cb36-312" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-313"><a href="#cb36-313" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=================================================================</span>     <span class="er">|</span>  <span class="dv">92</span>%</span>
<span id="cb36-314"><a href="#cb36-314" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-315"><a href="#cb36-315" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=================================================================</span>     <span class="er">|</span>  <span class="dv">93</span>%</span>
<span id="cb36-316"><a href="#cb36-316" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-317"><a href="#cb36-317" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================================================</span>    <span class="er">|</span>  <span class="dv">94</span>%</span>
<span id="cb36-318"><a href="#cb36-318" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-319"><a href="#cb36-319" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==================================================================</span>    <span class="er">|</span>  <span class="dv">95</span>%</span>
<span id="cb36-320"><a href="#cb36-320" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-321"><a href="#cb36-321" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================================================================</span>   <span class="er">|</span>  <span class="dv">95</span>%</span>
<span id="cb36-322"><a href="#cb36-322" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-323"><a href="#cb36-323" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================================================================</span>   <span class="er">|</span>  <span class="dv">96</span>%</span>
<span id="cb36-324"><a href="#cb36-324" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-325"><a href="#cb36-325" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====================================================================</span>  <span class="er">|</span>  <span class="dv">96</span>%</span>
<span id="cb36-326"><a href="#cb36-326" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-327"><a href="#cb36-327" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====================================================================</span>  <span class="er">|</span>  <span class="dv">97</span>%</span>
<span id="cb36-328"><a href="#cb36-328" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-329"><a href="#cb36-329" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====================================================================</span>  <span class="er">|</span>  <span class="dv">98</span>%</span>
<span id="cb36-330"><a href="#cb36-330" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-331"><a href="#cb36-331" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================================================================</span> <span class="er">|</span>  <span class="dv">98</span>%</span>
<span id="cb36-332"><a href="#cb36-332" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-333"><a href="#cb36-333" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================================================================</span> <span class="er">|</span>  <span class="dv">99</span>%</span>
<span id="cb36-334"><a href="#cb36-334" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-335"><a href="#cb36-335" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================================================|</span>  <span class="dv">99</span>%</span>
<span id="cb36-336"><a href="#cb36-336" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb36-337"><a href="#cb36-337" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================================================|</span> <span class="dv">100</span>%</span>
<span id="cb36-338"><a href="#cb36-338" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1153 out of 1964 input SNPs were not located within 10000 base-pairs of another SNP and were retained despite filtering</span></span>
<span id="cb36-339"><a href="#cb36-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-340"><a href="#cb36-340" aria-hidden="true" tabindex="-1"></a><span class="co">#assess clustering on the thinned dataset</span></span>
<span id="cb36-341"><a href="#cb36-341" aria-hidden="true" tabindex="-1"></a>miss<span class="ot">&lt;-</span><span class="fu">assess_missing_data_tsne</span>(vcfR.thin, popmap, <span class="at">clustering =</span> <span class="cn">FALSE</span>, <span class="at">iterations =</span> <span class="dv">5000</span>, <span class="at">perplexity =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-14-1.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-14-2.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#Wow, thinning to one SNP per locus totally removed the contamination issues we were seeing, and resulted in clean clustering patterns using t-SNE</span></code></pre></div>
</div>
<div id="see-if-this-thinned-datset-results-in-clean-pca-clustering" class="section level4">
<h4 class="hasAnchor">
<a href="#see-if-this-thinned-datset-results-in-clean-pca-clustering" class="anchor"></a>See if this thinned datset results in clean PCA clustering</h4>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#try using PCA clustering</span>
<span class="va">miss</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/assess_missing_data_pca.html">assess_missing_data_pca</a></span><span class="op">(</span><span class="va">vcfR.thin</span>, <span class="va">popmap</span>, clustering<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-15-1.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-15-2.png" width="700"></p>
</div>
<div id="we-can-clearly-see-here-that-a-single-sample-with-too-much-missing-data-ruins-pc1--interesting-to-note-that-the-same-amount-of-missing-data-that-is-tolerable-for-tsne-analysis-results-in-a-completely-wonky-pca--lets-check-out-what-removing-the-single-worst-missing-data-outlier-does-to-fix-this-problem-" class="section level4">
<h4 class="hasAnchor">
<a href="#we-can-clearly-see-here-that-a-single-sample-with-too-much-missing-data-ruins-pc1--interesting-to-note-that-the-same-amount-of-missing-data-that-is-tolerable-for-tsne-analysis-results-in-a-completely-wonky-pca--lets-check-out-what-removing-the-single-worst-missing-data-outlier-does-to-fix-this-problem-" class="anchor"></a>We can clearly see here that a single sample with too much missing data ruins PC1. Interesting to note that the same amount of missing data that is tolerable for tsne analysis results in a completely wonky PCA. Let’s check out what removing the single worst missing data outlier does to fix this problem.</h4>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#remove missing data outlier</span>
<span class="fu"><a href="../reference/missing_by_sample.html">missing_by_sample</a></span><span class="op">(</span><span class="va">vcfR.thin</span><span class="op">)</span>
<span class="co">#&gt; No popmap provided</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-16-1.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-16-2.png" width="700"></p>
<pre><code>#&gt;           indiv filt snps.retained
#&gt; 1   wesj-103135  0.5          1153
#&gt; 2   wesj-103200  0.5          1149
#&gt; 3   wesj-109289  0.5          1151
#&gt; 4   wesj-113832  0.5          1151
#&gt; 5   wesj-115531  0.5          1152
#&gt; 6    wesj-11931  0.5          1095
#&gt; 7    wesj-12581  0.5          1152
#&gt; 8    wesj-13355  0.5           560
#&gt; 9   wesj-144753  0.5           724
#&gt; 10  wesj-185534  0.5           788
#&gt; 11   wesj-20530  0.5          1150
#&gt; 12   wesj-29499  0.5          1151
#&gt; 13  wesj-343483  0.5          1147
#&gt; 14   wesj-34662  0.5          1143
#&gt; 15  wesj-346851  0.5          1148
#&gt; 16   wesj-38918  0.5          1149
#&gt; 17   wesj-46645  0.5          1148
#&gt; 18   wesj-50798  0.5           370
#&gt; 19   wesj-56723  0.5          1149
#&gt; 20   wesj-58167  0.5          1153
#&gt; 21   wesj-65019  0.5          1150
#&gt; 22   wesj-67235  0.5          1148
#&gt; 23     wesj-714  0.5           617
#&gt; 24    wesj-7334  0.5          1098
#&gt; 25   wesj-73921  0.5           911
#&gt; 26   wesj-85535  0.5          1148
#&gt; 27     wesj-B03  0.5          1153
#&gt; 28  wesj-103135  0.6          1153
#&gt; 29  wesj-103200  0.6          1149
#&gt; 30  wesj-109289  0.6          1151
#&gt; 31  wesj-113832  0.6          1151
#&gt; 32  wesj-115531  0.6          1152
#&gt; 33   wesj-11931  0.6          1095
#&gt; 34   wesj-12581  0.6          1152
#&gt; 35   wesj-13355  0.6           560
#&gt; 36  wesj-144753  0.6           724
#&gt; 37  wesj-185534  0.6           788
#&gt; 38   wesj-20530  0.6          1150
#&gt; 39   wesj-29499  0.6          1151
#&gt; 40  wesj-343483  0.6          1147
#&gt; 41   wesj-34662  0.6          1143
#&gt; 42  wesj-346851  0.6          1148
#&gt; 43   wesj-38918  0.6          1149
#&gt; 44   wesj-46645  0.6          1148
#&gt; 45   wesj-50798  0.6           370
#&gt; 46   wesj-56723  0.6          1149
#&gt; 47   wesj-58167  0.6          1153
#&gt; 48   wesj-65019  0.6          1150
#&gt; 49   wesj-67235  0.6          1148
#&gt; 50     wesj-714  0.6           617
#&gt; 51    wesj-7334  0.6          1098
#&gt; 52   wesj-73921  0.6           911
#&gt; 53   wesj-85535  0.6          1148
#&gt; 54     wesj-B03  0.6          1153
#&gt; 55  wesj-103135  0.7          1153
#&gt; 56  wesj-103200  0.7          1149
#&gt; 57  wesj-109289  0.7          1151
#&gt; 58  wesj-113832  0.7          1151
#&gt; 59  wesj-115531  0.7          1152
#&gt; 60   wesj-11931  0.7          1095
#&gt; 61   wesj-12581  0.7          1152
#&gt; 62   wesj-13355  0.7           560
#&gt; 63  wesj-144753  0.7           724
#&gt; 64  wesj-185534  0.7           788
#&gt; 65   wesj-20530  0.7          1150
#&gt; 66   wesj-29499  0.7          1151
#&gt; 67  wesj-343483  0.7          1147
#&gt; 68   wesj-34662  0.7          1143
#&gt; 69  wesj-346851  0.7          1148
#&gt; 70   wesj-38918  0.7          1149
#&gt; 71   wesj-46645  0.7          1148
#&gt; 72   wesj-50798  0.7           370
#&gt; 73   wesj-56723  0.7          1149
#&gt; 74   wesj-58167  0.7          1153
#&gt; 75   wesj-65019  0.7          1150
#&gt; 76   wesj-67235  0.7          1148
#&gt; 77     wesj-714  0.7           617
#&gt; 78    wesj-7334  0.7          1098
#&gt; 79   wesj-73921  0.7           911
#&gt; 80   wesj-85535  0.7          1148
#&gt; 81     wesj-B03  0.7          1153
#&gt; 82  wesj-103135  0.8          1153
#&gt; 83  wesj-103200  0.8          1149
#&gt; 84  wesj-109289  0.8          1151
#&gt; 85  wesj-113832  0.8          1151
#&gt; 86  wesj-115531  0.8          1152
#&gt; 87   wesj-11931  0.8          1095
#&gt; 88   wesj-12581  0.8          1152
#&gt; 89   wesj-13355  0.8           560
#&gt; 90  wesj-144753  0.8           724
#&gt; 91  wesj-185534  0.8           788
#&gt; 92   wesj-20530  0.8          1150
#&gt; 93   wesj-29499  0.8          1151
#&gt; 94  wesj-343483  0.8          1147
#&gt; 95   wesj-34662  0.8          1143
#&gt; 96  wesj-346851  0.8          1148
#&gt; 97   wesj-38918  0.8          1149
#&gt; 98   wesj-46645  0.8          1148
#&gt; 99   wesj-50798  0.8           370
#&gt; 100  wesj-56723  0.8          1149
#&gt; 101  wesj-58167  0.8          1153
#&gt; 102  wesj-65019  0.8          1150
#&gt; 103  wesj-67235  0.8          1148
#&gt; 104    wesj-714  0.8           617
#&gt; 105   wesj-7334  0.8          1098
#&gt; 106  wesj-73921  0.8           911
#&gt; 107  wesj-85535  0.8          1148
#&gt; 108    wesj-B03  0.8          1153
#&gt; 109 wesj-103135  0.9           449
#&gt; 110 wesj-103200  0.9           449
#&gt; 111 wesj-109289  0.9           449
#&gt; 112 wesj-113832  0.9           448
#&gt; 113 wesj-115531  0.9           448
#&gt; 114  wesj-11931  0.9           443
#&gt; 115  wesj-12581  0.9           449
#&gt; 116  wesj-13355  0.9           306
#&gt; 117 wesj-144753  0.9           408
#&gt; 118 wesj-185534  0.9           414
#&gt; 119  wesj-20530  0.9           448
#&gt; 120  wesj-29499  0.9           449
#&gt; 121 wesj-343483  0.9           446
#&gt; 122  wesj-34662  0.9           449
#&gt; 123 wesj-346851  0.9           448
#&gt; 124  wesj-38918  0.9           448
#&gt; 125  wesj-46645  0.9           448
#&gt; 126  wesj-50798  0.9           219
#&gt; 127  wesj-56723  0.9           448
#&gt; 128  wesj-58167  0.9           449
#&gt; 129  wesj-65019  0.9           449
#&gt; 130  wesj-67235  0.9           449
#&gt; 131    wesj-714  0.9           346
#&gt; 132   wesj-7334  0.9           448
#&gt; 133  wesj-73921  0.9           418
#&gt; 134  wesj-85535  0.9           449
#&gt; 135    wesj-B03  0.9           449
#&gt; 136 wesj-103135  1.0            72
#&gt; 137 wesj-103200  1.0            72
#&gt; 138 wesj-109289  1.0            72
#&gt; 139 wesj-113832  1.0            72
#&gt; 140 wesj-115531  1.0            72
#&gt; 141  wesj-11931  1.0            72
#&gt; 142  wesj-12581  1.0            72
#&gt; 143  wesj-13355  1.0            72
#&gt; 144 wesj-144753  1.0            72
#&gt; 145 wesj-185534  1.0            72
#&gt; 146  wesj-20530  1.0            72
#&gt; 147  wesj-29499  1.0            72
#&gt; 148 wesj-343483  1.0            72
#&gt; 149  wesj-34662  1.0            72
#&gt; 150 wesj-346851  1.0            72
#&gt; 151  wesj-38918  1.0            72
#&gt; 152  wesj-46645  1.0            72
#&gt; 153  wesj-50798  1.0            72
#&gt; 154  wesj-56723  1.0            72
#&gt; 155  wesj-58167  1.0            72
#&gt; 156  wesj-65019  1.0            72
#&gt; 157  wesj-67235  1.0            72
#&gt; 158    wesj-714  1.0            72
#&gt; 159   wesj-7334  1.0            72
#&gt; 160  wesj-73921  1.0            72
#&gt; 161  wesj-85535  1.0            72
#&gt; 162    wesj-B03  1.0            72
vcfR.thin&lt;-missing_by_sample(vcfR.thin, cutoff = .6)
#&gt; 1 samples are above a 0.6 missing data cutoff, and were removed from VCF</code></pre>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-16-3.png" width="700"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#subset popmap</span>
<span class="va">popmap</span><span class="op">&lt;-</span><span class="va">popmap</span><span class="op">[</span><span class="va">popmap</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">vcfR.thin</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span>,<span class="op">]</span>
<span class="co">#remove invariant sites</span>
<span class="va">vcfR.thin</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/min_mac.html">min_mac</a></span><span class="op">(</span><span class="va">vcfR.thin</span>, min.mac <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; 7.2% of SNPs fell below a minor allele count of 1 and were removed from the VCF</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-16-4.png" width="700"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#recluster</span>
<span class="va">miss</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/assess_missing_data_pca.html">assess_missing_data_pca</a></span><span class="op">(</span><span class="va">vcfR.thin</span>, <span class="va">popmap</span>, clustering<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-16-5.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-16-6.png" width="700"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#missing data still driving PC2</span></code></pre></div>
</div>
<div id="missing-data-is-still-driving-patterns-of-clustering-in-a-pca-lets-go-back-to-visualizing-missing-data-by-sample" class="section level4">
<h4 class="hasAnchor">
<a href="#missing-data-is-still-driving-patterns-of-clustering-in-a-pca-lets-go-back-to-visualizing-missing-data-by-sample" class="anchor"></a>missing data is still driving patterns of clustering in a PCA, let’s go back to visualizing missing data by sample</h4>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">miss</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/missing_by_sample.html">missing_by_sample</a></span><span class="op">(</span><span class="va">vcfR.thin</span><span class="op">)</span>
<span class="co">#&gt; No popmap provided</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-17-1.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
</div>
<div id="we-can-see-that-there-are-4-5-samples-with-a-lot-of-missing-data-still-even-after-all-of-our-stringent-filtering-cutoffs-to-the-point-that-it-is-driving-clustering-patterns-in-a-pca--this-highlights-the-relative-nature-of-snp-filtering-protocols--if-your-goal-is-to-perform-t-sne-clustering-you-may-be-able-to-retain-all-of-the-samples--meanwhile-if-you-want-to-use-pca-for-clustering-you-would-want-to-drop-the-seven-samples-with-low-data-identified-at-the-beginning-of-our-filtering-exploration-step-3-" class="section level4">
<h4 class="hasAnchor">
<a href="#we-can-see-that-there-are-4-5-samples-with-a-lot-of-missing-data-still-even-after-all-of-our-stringent-filtering-cutoffs-to-the-point-that-it-is-driving-clustering-patterns-in-a-pca--this-highlights-the-relative-nature-of-snp-filtering-protocols--if-your-goal-is-to-perform-t-sne-clustering-you-may-be-able-to-retain-all-of-the-samples--meanwhile-if-you-want-to-use-pca-for-clustering-you-would-want-to-drop-the-seven-samples-with-low-data-identified-at-the-beginning-of-our-filtering-exploration-step-3-" class="anchor"></a>We can see that there are 4-5 samples with a lot of missing data still even after all of our stringent filtering cutoffs, to the point that it is driving clustering patterns in a PCA. This highlights the relative nature of SNP filtering protocols. If your goal is to perform t-SNE clustering, you may be able to retain all of the samples. Meanwhile, if you want to use PCA for clustering, you would want to drop the seven samples with low-data identified at the beginning of our filtering exploration (Step 3).</h4>
</div>
<div id="remove-the-five-remaining-low-data-samples" class="section level4">
<h4 class="hasAnchor">
<a href="#remove-the-five-remaining-low-data-samples" class="anchor"></a>Remove the five remaining low data samples</h4>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#set cutoff</span>
<span class="va">vcfR.thin.drop</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/missing_by_sample.html">missing_by_sample</a></span><span class="op">(</span><span class="va">vcfR.thin</span>, cutoff <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span>
<span class="co">#&gt; 4 samples are above a 0.25 missing data cutoff, and were removed from VCF</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#subset popmap</span>
<span class="va">popmap</span><span class="op">&lt;-</span><span class="va">popmap</span><span class="op">[</span><span class="va">popmap</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">vcfR.thin.drop</span><span class="op">@</span><span class="va">gt</span><span class="op">)</span>,<span class="op">]</span>
<span class="co">#remove invariant sites</span>
<span class="va">vcfR.thin.drop</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/min_mac.html">min_mac</a></span><span class="op">(</span><span class="va">vcfR.thin.drop</span>, min.mac <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; 34.3% of SNPs fell below a minor allele count of 1 and were removed from the VCF</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-18-2.png" width="700"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#recluster</span>
<span class="va">miss</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/assess_missing_data_pca.html">assess_missing_data_pca</a></span><span class="op">(</span><span class="va">vcfR.thin.drop</span>, <span class="va">popmap</span>, clustering<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-18-3.png" width="700"><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-18-4.png" width="700"></p>
</div>
<div id="pca-clustering-now-looks-much-better" class="section level4">
<h4 class="hasAnchor">
<a href="#pca-clustering-now-looks-much-better" class="anchor"></a>PCA clustering now looks much better</h4>
</div>
<div id="lets-compare-overall-depth-and-genotype-quality-from-the-two-datasets-with-and-without-dropping-5-samples-using-some-excellent-functions-from-vcfr" class="section level4">
<h4 class="hasAnchor">
<a href="#lets-compare-overall-depth-and-genotype-quality-from-the-two-datasets-with-and-without-dropping-5-samples-using-some-excellent-functions-from-vcfr" class="anchor"></a>let’s compare overall depth and genotype quality from the two datasets (with and without dropping 5+ samples) using some excellent functions from vcfR</h4>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plot depth per snp and per sample for the filtered, thinned dataset</span>
<span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/extract_gt.html">extract.gt</a></span><span class="op">(</span><span class="va">vcfR.thin</span>, element <span class="op">=</span> <span class="st">"DP"</span>, as.numeric<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/heatmap_bp.html">heatmap.bp</a></span><span class="op">(</span><span class="va">dp</span>, rlabels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-19-1.png" width="900"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#plot depth per snp and per sample for the filtered, thinned dataset with samples dropped</span>
<span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/extract_gt.html">extract.gt</a></span><span class="op">(</span><span class="va">vcfR.thin.drop</span>, element <span class="op">=</span> <span class="st">"DP"</span>, as.numeric<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/heatmap_bp.html">heatmap.bp</a></span><span class="op">(</span><span class="va">dp</span>, rlabels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-19-2.png" width="900"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plot depth per snp and per sample for the filtered, thinned dataset</span>
<span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/extract_gt.html">extract.gt</a></span><span class="op">(</span><span class="va">vcfR.thin</span>, element <span class="op">=</span> <span class="st">"GQ"</span>, as.numeric<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/heatmap_bp.html">heatmap.bp</a></span><span class="op">(</span><span class="va">dp</span>, rlabels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-20-1.png" width="900"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#plot depth per snp and per sample for the filtered, thinned dataset with samples dropped</span>
<span class="va">dp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/extract_gt.html">extract.gt</a></span><span class="op">(</span><span class="va">vcfR.thin.drop</span>, element <span class="op">=</span> <span class="st">"GQ"</span>, as.numeric<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vcfR/man/heatmap_bp.html">heatmap.bp</a></span><span class="op">(</span><span class="va">dp</span>, rlabels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="scrub-jay-UCE-vignette_files/figure-html/unnamed-chunk-20-2.png" width="900"></p>
</div>
<div id="we-can-see-that-these-five-problematic-samples-have-low-depth-of-sequencing-low-quality-on-called-genotypes-and-high-amounts-of-missing-data--retaining-these-samples-may-be-possible-depending-on-which-analyses-you-wish-to-perform--the-paper-sequence-capture-of-ultraconserved-elements-from-bird-museum-specimens-showed-that-some-analyses-such-as-creating-a-snapp-species-tree-worked-quite-well-despite-these-poor-quality-samples-while-other-analyses-such-as-structure-were-sensitive-to-the-high-missing-data-and-potential-contamination-in-these-low-quality-samples--regardless-of-your-goals-snpfiltr-allows-you-to-quickly-document-your-preliminary-analyses-and-filtering-decisions-as-you-investigate-your-snp-dataset-" class="section level4">
<h4 class="hasAnchor">
<a href="#we-can-see-that-these-five-problematic-samples-have-low-depth-of-sequencing-low-quality-on-called-genotypes-and-high-amounts-of-missing-data--retaining-these-samples-may-be-possible-depending-on-which-analyses-you-wish-to-perform--the-paper-sequence-capture-of-ultraconserved-elements-from-bird-museum-specimens-showed-that-some-analyses-such-as-creating-a-snapp-species-tree-worked-quite-well-despite-these-poor-quality-samples-while-other-analyses-such-as-structure-were-sensitive-to-the-high-missing-data-and-potential-contamination-in-these-low-quality-samples--regardless-of-your-goals-snpfiltr-allows-you-to-quickly-document-your-preliminary-analyses-and-filtering-decisions-as-you-investigate-your-snp-dataset-" class="anchor"></a>We can see that these five problematic samples have low depth of sequencing, low quality on called genotypes, and high amounts of missing data. Retaining these samples may be possible depending on which analyses you wish to perform. The paper <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/1755-0998.12466">Sequence capture of ultraconserved elements from bird museum specimens</a> showed that some analyses such as creating a SNAPP species tree worked quite well despite these poor quality samples, while other analyses such as STRUCTURE were sensitive to the high missing data and potential contamination in these low quality samples. Regardless of your goals, SNPfiltR allows you to quickly document your preliminary analyses and filtering decisions as you investigate your SNP dataset.</h4>
</div>
</div>
</div>
<div id="step-6-write-out-vcf-files-for-downstream-analyses-" class="section level1">
<h1 class="hasAnchor">
<a href="#step-6-write-out-vcf-files-for-downstream-analyses-" class="anchor"></a>Step 6: write out vcf files for downstream analyses.</h1>
<div id="note-4" class="section level3">
<h3 class="hasAnchor">
<a href="#note-4" class="anchor"></a>Note:</h3>
<div id="the-function-vcfrwrite-vcf-automatically-writes-a-gzipped-vcf-file-so-be-sure-to-add-the-suffix--gz-to-the-name-of-your-output-file-" class="section level4">
<h4 class="hasAnchor">
<a href="#the-function-vcfrwrite-vcf-automatically-writes-a-gzipped-vcf-file-so-be-sure-to-add-the-suffix--gz-to-the-name-of-your-output-file-" class="anchor"></a>The function vcfR::write.vcf() automatically writes a gzipped vcf file, so be sure to add the suffix .gz to the name of your output file.</h4>
</div>
<div id="write-out-the-filtered-thinned-vcf-with-and-without-extra-samples-dropped-for-use-in-downstream-analyses" class="section level4">
<h4 class="hasAnchor">
<a href="#write-out-the-filtered-thinned-vcf-with-and-without-extra-samples-dropped-for-use-in-downstream-analyses" class="anchor"></a>Write out the filtered, thinned vcf, with and without extra samples dropped, for use in downstream analyses</h4>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#write out vcf with all SNPs</span>
<span class="co">#vcfR::write.vcf(vcfR.thin, "~/Downloads/aphelocoma.uce.filtered.thinned.vcf.gz")</span>

<span class="co">#write out thinned vcf</span>
<span class="co">#vcfR::write.vcf(vcfR.thin.drop, "~/Downloads/aphelocoma.uce.filtered.thinned.drop.vcf.gz")</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devon DeRaad.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
